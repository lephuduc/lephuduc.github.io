<!doctype html>
<html
  lang="en-us" 
  
    data-theme-mode="true"
  
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>







  

<title>
  TetCTF 2024 | Le Phu Duc
</title>
<meta
  name="description"
  content="Writeup for TetCTF 2024"
/>



  <script>
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "true");
</script>


  
<script src="https://www.googletagmanager.com/gtag/js?id=true"></script>
<script data-pjax>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }

  gtag('js', new Date());

  gtag('config', 'true');
</script>








<script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"clipboard\":{\"copyright\":{\"content\":\"All articles in this blog are licensed under BY-NC-SA unless otherwise stated. Please indicate the source when reprinting!\",\"count\":50,\"enable\":false},\"fail\":\"Failed to copy (ﾟ⊿ﾟ)ﾂ\",\"success\":\"Copied\"},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_0khxww3tj3q9\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":\"This article was last updated on {time}. Please note that the content may have changed.\"}}");
</script>











  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  


<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cUbuntu%20Mono:400,400italic,700,700italic%7cSource%20Code%20Pro:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cUbuntu%20Mono:400,400italic,700,700italic%7cSource%20Code%20Pro:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>






  <link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  />








<link rel="shortcut icon" href="/favicon/favicon.ico">







 <link rel="stylesheet" href="/css/main.css" />





  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />






  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />








  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    
    
    
    
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"
  ></script>





  


  <link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css" />








  <link rel="stylesheet" href="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.css" />



  </head>
  <body>
    

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        
<div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe632;
          
        </div>
        <a class="main-nav-link" href="/">Home</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe628;
          
        </div>
        <a class="main-nav-link" href="/about">About</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe604;
          
        </div>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe621;
          
        </div>
        <a class="main-nav-link" href="/achievements">Achievements</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="Search"></a>
    
  </nav>
</div>
<header id="header">
  
    
    <picture></picture>
      <img fetchpriority="high" src="/images/post_covers/tetctf2024.jpeg" alt="TetCTF 2024">
    
  

  <div id="header-outer">
    <div id="header-title">
      
        
        
          
        
  
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">TetCTF 2024</h1>
          </a>
        
      
  
      
        
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>
        <div id="content"
          class="sidebar-left"
            >
          <aside id="sidebar">
  
    <div id="aplayer" theme="var(--color-link)" data-aos="fade-up"></div>
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    >
      
        <div class="sidebar-toc-sidebar">
          <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#binary">Binary</a></li>
    <li><a href="#writing-disassembler">Writing disassembler</a></li>
    <li><a href="#analyzing">Analyzing</a></li>
    <li><a href="#solving">Solving</a></li>
    <li><a href="#bonus">Bonus</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
  </div>
</div>
        </div>
        <div class="sidebar-common-sidebar hidden">
          
<div class="sidebar-author">
  <img
    data-src="/avatar/shiba.jpg"
    data-sizes="auto"
    alt="Le Phu Duc"
    class="lazyload"
  />
  <div class="sidebar-author-name">Le Phu Duc</div>
  <div class="sidebar-description">a.k.a Jinn</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">18</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      2
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">7</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-discord sidebar-social-icon">
      <a
        href="https://discordapp.com/users/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="discord"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-facebook sidebar-social-icon">
      <a
        href="https://www.facebook.com/lephuduc0309"
        itemprop="url"
        target="_blank"
        aria-label="facebook"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a
        href="https://github.com/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="github"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-instagram sidebar-social-icon">
      <a
        href="https://www.instagram.com/le.phuduc"
        itemprop="url"
        target="_blank"
        aria-label="instagram"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-linkedin sidebar-social-icon">
      <a
        href="https://www.linkedin.com/in/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="linkedin"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-twitter sidebar-social-icon">
      <a
        href="https://twitter.com/lephuduck"
        itemprop="url"
        target="_blank"
        aria-label="twitter"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

        </div>
      

      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  <div class="sidebar-widget">
    
  </div>
</aside>

          <section id="main">
  <article
  class="h-entry article"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta">
      <div class="article-date">
  <a
    href="http://localhost:1313/post/tetctf-2024/"
    class="article-date-link"
    data-aos="zoom-in"
  >
    <time datetime="2024-01-29 00:00:00 &#43;0000 UTC" itemprop="datePublished"
      >2024-01-29</time
    >
    <time style="display: none;" id="post-update-time"
      >2024-01-29</time
    >
  </a>
</div>

      <div class="article-category">
  
    <a
      class="article-category-link"
      href="/categories/writeup"
      data-aos="zoom-in"
      >WRITEUP</a
    >
  
</div>

    </div>
    <div class="hr-line"></div>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h1 id="rusty-vm---tetctf-2024">
<a class="header-anchor" href="#rusty-vm---tetctf-2024"></a>
Rusty VM - TetCTF 2024
</h1><p>TetCTF 2024 vừa rồi là giải TetCTF thứ 3 mà mình tham gia, tuy nhiên lần này có chúc ấn tượng rằng đề khá là thú vị. Với 2 bài đầu thì mình cảm thấy cũng khá đơn giản nên mình không note ở đây, còn 1 bài khác nữa tuy nhiên vì mình nghĩ rằng giải 24 giờ nên bài đó mình đã bỏ qua, đến lúc nhận ra thi đã quá muộn&hellip;</p>
<p><img src="https://hackmd.io/_uploads/HkOnA-Bqa.png" alt="image"></p>
<p>Về bài này thì mình cảm thấy cũng không khó nhưng mà những script solve hay disassmbler mình bỏ ở PC nên giờ mình không truy cập được, đành phải viết lại toàn bộ thôi :V.</p>
<h2 id="binary">
<a class="header-anchor" href="#binary"></a>
Binary
</h2><p>Đây là <code>sub_9DA0</code> cũng là hàm xử lí chính trong chương trình, nó lấy input, load bytecode (unk_4B170), run bytecode,&hellip;</p>
<p><img src="https://hackmd.io/_uploads/B1WIZyr5p.png" alt="image"></p>
<p>Và đây là mainloop cũng như switchcase xử lí chính trong chương trình.</p>
<p><img src="https://hackmd.io/_uploads/rJwMfJHqp.png" alt="image"></p>
<p>Đối với cá nhân mình thì rev VM vẫn quan trọng nhất là xác định được các yếu tố sau:</p>
<pre><code>- opcode
- register
- memory
- instruction pointer
- stack
</code></pre>
<p>Đầu tiên, ta có 1 buffer cơ bản, tạm gọi là <code>mem</code>, sau khi rev sơ mình biết được là các thanh ghi nằm ở vị trí <code>&amp;mem + 0x3000</code>, có tổng cộng 9 register, size là 16 bit.</p>
<p>Stack nằm ở <code>&amp;mem + 0x1000</code> và phần đầu của <code>mem</code> sẽ chứa input của chúng ta.</p>
<p>Mỗi opcode đều lấy 1 byte đầu của instruction, instruction length không cố định, có thể là 2, 3 hoặc 4 byte.</p>
<p><img src="https://hackmd.io/_uploads/S1bBNJr9a.png" alt="image"></p>
<p><img src="https://hackmd.io/_uploads/S118EJHqp.png" alt="image"></p>
<p>Ta thấy rằng các instruction đầu thường là các operator cơ bản như mov, add, sub, and, or, not, xor,&hellip;</p>
<p>Tiếp theo là các instruction khó hơn là cmp hoặc jmp, jne, jg&hellip;</p>
<p><img src="https://hackmd.io/_uploads/rkgyrkBca.png" alt="image"></p>
<p>Và trong vm lần này có cả <code>call</code> và <code>ret</code> lý do mình thấy vì ngoài lệnh <code>push</code>, <code>pop</code> tương tác với stack ra nó còn push <code>return address</code> lên stack và ngược lại.</p>
<p><img src="https://hackmd.io/_uploads/r1teSJHq6.png" alt="image"></p>
<h2 id="writing-disassembler">
<a class="header-anchor" href="#writing-disassembler"></a>
Writing disassembler
</h2><p>Do đó từ các dữ kiện này mình có thể dễ dàng viết ra một disassembler cơ bản.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">code</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x01\x00\x01\x00\x01\x01</span><span class="s1">p</span><span class="se">\x00\x01\x02\x02\x00\x19\x01\x00\x02\x01\x02\x19\x01\x00\x02\x01\x02\x01\x00\x02\x00\x19\x01\x00\x02\x01\x02\x19\x01\x00\x01\x00\xff\xff\x02\x01\x02\x19\x01\x00\x02\x01\x02\x19\x01\x00\x01\x00\xfe\xff\x02\x01\x02\x19\x01\x00\x02\x01\x02\x19\x01\x00\x01\x00\x02\x00\x01\x01\x80\x00\x19\x01\x00\x01\x00\xfe\xff\x02\x01\x02\x19\x01\x00\x01\x00\x01\x00\x02\x01\x02\x19\x01\x00\x01\x00\xff\xff\x02\x01\x02\x19\x01\x00\x01\x00\x02\x00\x02\x01\x02\x19\x01\x00\x01\x00\xfe\xff\x02\x01\x02\x19\x01\x00\x01\x00\x01\x00\x02\x01\x02\x19\x01\x00\x01\x00\xff\xff\x02\x01\x02\x19\x01\x00\x01\x07\x02\x00\x01\x08\x06\x00\x1a</span><span class="s1">h</span><span class="se">\x01\x01\x03\x00\x00\x01\x01\x00\x00\x02\x01\x03\x04\x01\x01\x00\x02\x01\x01\x04\x04\x00\x0e\x02\x04\x01\x04\x0f\x00\x0b\x01\x04\x1a\xf1\x00\x01\x04\x00\x00\x11\x00\x04\x13\xed\x00\x00\x07\x01\x00\x08\x02\x1a\x8c\x01\x01\x04\x01\x00\x11\x00\x04\x13\xed\x00\x1a</span><span class="s1">h</span><span class="se">\x01\x01\x01\x01\x00\x02\x03\x01\x12\xa5\x00\x1a\xac\x01\x17\x0f\x03\x0f\x04\x0f\x05\x0f\x06\x01\x03\x07\x00\x01\x04\xff\xff\x11\x01\x04\x16</span><span class="s1">T</span><span class="se">\x01\x11\x01\x03\x15</span><span class="s1">T</span><span class="se">\x01\x11\x02\x04\x16</span><span class="s1">T</span><span class="se">\x01\x11\x02\x03\x15</span><span class="s1">T</span><span class="se">\x01\x01\x04\x00\x00\x01\x03</span><span class="s1">p</span><span class="se">\x00\x02\x03\x04\x05\x03\x03\x02\x03\x07\x11\x03\x01\x14</span><span class="s1">C</span><span class="se">\x01\x01\x03\x80\x00\x02\x03\x04\x05\x03\x03\x02\x03\x08\x11\x03\x02\x13</span><span class="s1">[</span><span class="se">\x01\x01\x03\x02\x00\x02\x04\x03\x01\x03\x0e\x00\x11\x04\x03\x16\x1d\x01\x01\x00\x00\x00\x12</span><span class="s1">_</span><span class="se">\x01\x01\x00\x01\x00\x10\x06\x10\x05\x10\x04\x10\x03\x1b\x0f\x01\x0f\x02\x0f\x03\x01\x01\xa0\x00\x02\x01\x08\x04\x03\x01\x01\x02\x01\x00\r\x02\x07\x0c\x03\x02\x18\x01\x03\x10\x03\x10\x02\x10\x01\x1b\x0f\x01\x0f\x02\x01\x01\xa0\x00\x02\x01\x08\x04\x01\x01\x0e\x01\x07\x01\x02\x01\x00\x0b\x01\x02\x00\x00\x01\x10\x02\x10\x01\x1b\x0f\x01\x0f\x02\x0f\x03\x0f\x04\x01\x00\x00\x00\x01\x01\xa0\x00\x01\x02\xa8\x00\x01\x03\x01\x00\x04\x04\x01\x02\x00\x04\x02\x01\x03\x11\x01\x02\x14\xc4\x01\x01\x01\xf8\x07\x00\x02\x00\x01\x00\x00\x00\x11\x01\x02\x14\xfc\x01\x01\x01\x07\x00\x11\x07\x01\x14\xfc\x01\x01\x01\x02\x00\x11\x08\x01\x14\xfc\x01\x01\x00\x01\x00\x10\x04\x10\x03\x10\x02\x10\x01\x1b</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">ip</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">opcode</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">ins</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;L_</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span><span class="si">}</span><span class="s1">:   </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">match</span> <span class="n">opcode</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mov reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v3</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mov reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">hex</span><span class="p">((</span><span class="n">v3</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">|</span><span class="n">v2</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;add reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;sub reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mov reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, BYTE mem[reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">]&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mov reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, WORD mem[reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">]&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">6</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mul reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;div reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mod reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">9</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;xor reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;not reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">11</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;and reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">12</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;or reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">13</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;shl reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">14</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;shr reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">15</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;push reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;pop reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">17</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;cmp reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">, reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">18</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;jmp </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">v1</span><span class="o">|</span><span class="p">(</span><span class="n">v2</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">))</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">19</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;je </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">v1</span><span class="o">|</span><span class="p">(</span><span class="n">v2</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">))</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span> 
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">20</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;jne </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">v1</span><span class="o">|</span><span class="p">(</span><span class="n">v2</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">))</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span> 
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">21</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;jl </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">v1</span><span class="o">|</span><span class="p">(</span><span class="n">v2</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">))</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">22</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;jge </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">v1</span><span class="o">|</span><span class="p">(</span><span class="n">v2</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">))</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">23</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;final check ;(reg0==1)?(WIN:LOST)</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">24</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mov BYTE [reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">], reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">25</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;mov WORD [reg</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">], reg</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">26</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">v1</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">v2</span> <span class="o">=</span> <span class="n">code</span><span class="p">[</span><span class="n">ip</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;call </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">v1</span><span class="o">|</span><span class="p">(</span><span class="n">v2</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">))</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">27</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;ret</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="mi">28</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">ins</span> <span class="o">=</span> <span class="s1">&#39;exit&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ip</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="n">_</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unknown opcode!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
</span></span></code></pre></div><p>Vì số lượng instruction cũng ít nên mình dùng switchcase cho nhanh, sau khi disassemble và chỉnh sửa 1 tí thì mình được đoạn code đẹp như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">L_0x0:</span>   <span class="err">1</span>          <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x4:</span>   <span class="err">1</span>          <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x70</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x8:</span>   <span class="err">1</span>          <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc:</span>   <span class="err">25</span>         <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf:</span>   <span class="err">2</span>          <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x12:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x15:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x18:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x22:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x25:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x29:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x2c:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x2f:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x32:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x35:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0xfffe</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x39:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x3c:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x3f:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x42:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x45:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x49:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x80</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x4d:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x50:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0xfffe</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x54:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x57:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x5a:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x5e:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x61:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x64:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x68:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x6b:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x6e:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x72:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x75:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x78:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0xfffe</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x7c:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x7f:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x82:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x86:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x89:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x8c:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x90:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x93:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x96:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg7</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x9a:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg8</span><span class="p">,</span> <span class="mi">0x6</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x9e:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x168</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xa1:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xa5:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xa9:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xac:</span>   <span class="err">4</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xaf:</span>   <span class="err">0</span>         <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xb2:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xb6:</span>   <span class="err">14</span>        <span class="nf">shr</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xb9:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0xf</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xbd:</span>   <span class="err">11</span>        <span class="nf">and</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc0:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0xf1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc3:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc7:</span>   <span class="err">17</span>        <span class="nf">cmp</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xca:</span>   <span class="err">19</span>        <span class="nf">je</span> <span class="mi">0xed</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xcd:</span>   <span class="err">0</span>         <span class="nf">mov</span> <span class="no">reg7</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xd0:</span>   <span class="err">0</span>         <span class="nf">mov</span> <span class="no">reg8</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xd3:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x18c</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xd6:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xda:</span>   <span class="err">17</span>        <span class="nf">cmp</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xdd:</span>   <span class="err">19</span>        <span class="nf">je</span> <span class="mi">0xed</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xe0:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x168</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xe3:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xe7:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xea:</span>   <span class="err">18</span>        <span class="nf">jmp</span> <span class="mi">0xa5</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xed:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x1ac</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf0:</span>   <span class="err">23</span>        <span class="nf">final</span> <span class="no">check</span> <span class="c1">;(reg0==1)?(WIN:LOST)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf1:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf3:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf5:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg5</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf7:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg6</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf9:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xfd:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x101:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x104:</span>   <span class="err">22</span>       <span class="nf">jle</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x107:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x10a:</span>   <span class="err">21</span>       <span class="nf">jg</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x10d:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x110:</span>   <span class="err">22</span>       <span class="nf">jle</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x113:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x116:</span>   <span class="err">21</span>       <span class="nf">jg</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x119:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x11d:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x70</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x121:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x124:</span>   <span class="err">5</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">WORD</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x127:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x12a:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x12d:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x143</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x130:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x80</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x134:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x137:</span>   <span class="err">5</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">WORD</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x13a:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x13d:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x140:</span>   <span class="err">19</span>       <span class="nf">je</span> <span class="mi">0x15b</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x143:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x147:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg4</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x14a:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0xe</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x14e:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg4</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x151:</span>   <span class="err">22</span>       <span class="nf">jle</span> <span class="mi">0x11d</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x154:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x158:</span>   <span class="err">18</span>       <span class="nf">jmp</span> <span class="mi">0x15f</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x15b:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x15f:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg6</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x161:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg5</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x163:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x165:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x167:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">L_0x168:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x16a:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x16c:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x16e:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0xa0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x172:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x175:</span>   <span class="err">4</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x178:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x17c:</span>   <span class="err">13</span>       <span class="nf">shl</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x17f:</span>   <span class="err">12</span>       <span class="nf">or</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x182:</span>   <span class="err">24</span>       <span class="nf">mov</span> <span class="no">BYTE</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x185:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x187:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x189:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x18b:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">L_0x18c:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x18e:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x190:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0xa0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x194:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x197:</span>   <span class="err">4</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x19a:</span>   <span class="err">14</span>       <span class="nf">shr</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x19d:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a1:</span>   <span class="err">11</span>       <span class="nf">and</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a4:</span>   <span class="err">0</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a7:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a9:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ab:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ac:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ae:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b0:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b2:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b4:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b8:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0xa0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1bc:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0xa8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c0:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c4:</span>   <span class="err">4</span>        <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c7:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ca:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1cd:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1d0:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1c4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1d3:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x7f8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1d7:</span>   <span class="err">0</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1da:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1de:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1e1:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1fc</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1e4:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1e8:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg7</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1eb:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1fc</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ee:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f2:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg8</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f5:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1fc</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f8:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1fc:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1fe:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x200:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x202:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x204:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span></code></pre></div><h2 id="analyzing">
<a class="header-anchor" href="#analyzing"></a>
Analyzing
</h2><p>Ta có thể thấy ngay chương trình có 1 hàm main và 4 hàm khác, tiến hành phân tích từng cái một:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">L_0x168:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x16a:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x16c:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x16e:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0xa0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x172:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x175:</span>   <span class="err">4</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">input</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x178:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x17c:</span>   <span class="err">13</span>       <span class="nf">shl</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x17f:</span>   <span class="err">12</span>       <span class="nf">or</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x182:</span>   <span class="err">24</span>       <span class="nf">mov</span> <span class="no">BYTE</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x185:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x187:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x189:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x18b:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span></code></pre></div><p>Xuất phát từ hàm 0x168 trước vì nó ngắn, hàm này đang cố enable 1 bit từ index cho sẵn:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0x168</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg3</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">reg8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg3</span> <span class="o">=</span> <span class="n">reg3</span><span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">reg7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">reg8</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg3</span>
</span></span></code></pre></div><p>Tương tự với hàm 0x18c, hàm này ngược lại với hàm trên, nó lấy 1 bit từ index cho sẵn:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">L_0x18c:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x18e:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x190:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0xa0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x194:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x197:</span>   <span class="err">4</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x19a:</span>   <span class="err">14</span>       <span class="nf">shr</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x19d:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a1:</span>   <span class="err">11</span>       <span class="nf">and</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a4:</span>   <span class="err">0</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a7:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1a9:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ab:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0x18c</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg1</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">reg8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">reg1</span><span class="o">&gt;&gt;</span><span class="n">reg7</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span>
</span></span></code></pre></div><p>Hàm ở L_0x1ac là hàm cuối cùng được gọi trong main, nó tính tổng 0xa8 các phần tử liên tiếp tại <code>&amp;mem + 0xa0</code>, và check xem <code>reg7==7 &amp;&amp; reg8==2</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">L_0x1ac:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ae:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b0:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b2:</span>   <span class="err">15</span>       <span class="nf">push</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b4:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1b8:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0xa0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1bc:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0xa8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c0:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c4:</span>   <span class="err">4</span>        <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1c7:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ca:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1cd:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1d0:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1c4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1d3:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x7f8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1d7:</span>   <span class="err">0</span>        <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1da:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1de:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1e1:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1fc</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1e4:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1e8:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg7</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1eb:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1fc</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1ee:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f2:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg8</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f5:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x1fc</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1f8:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1fc:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x1fe:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x200:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x202:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x204:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0x1ac</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xa8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg4</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">+=</span> <span class="n">reg4</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="mh">0x7f8</span> <span class="ow">and</span> <span class="n">reg7</span><span class="o">==</span><span class="mi">7</span> <span class="ow">and</span> <span class="n">reg8</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span>
</span></span></code></pre></div><p>Đối với hàm tại 0xf1 thì nó nhận 2 tham số vào reg1 và reg2, sau đó thực hiện các thao tác để check 2 tham số này:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">L_0xf1:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf3:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf5:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg5</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf7:</span>   <span class="err">15</span>        <span class="nf">push</span> <span class="no">reg6</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf9:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xfd:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x101:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x104:</span>   <span class="err">22</span>       <span class="nf">jge</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x107:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x10a:</span>   <span class="err">21</span>       <span class="nf">jl</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x10d:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x110:</span>   <span class="err">22</span>       <span class="nf">jge</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x113:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x116:</span>   <span class="err">21</span>       <span class="nf">jl</span> <span class="mi">0x154</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x119:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x11d:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x70</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x121:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x124:</span>   <span class="err">5</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">WORD</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x127:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg7</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x12a:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x12d:</span>   <span class="err">20</span>       <span class="nf">jne</span> <span class="mi">0x143</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x130:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x80</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x134:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x137:</span>   <span class="err">5</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">WORD</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x13a:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg8</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x13d:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x140:</span>   <span class="err">19</span>       <span class="nf">je</span> <span class="mi">0x15b</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x143:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x147:</span>   <span class="err">2</span>        <span class="nf">add</span> <span class="no">reg4</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x14a:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0xe</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x14e:</span>   <span class="err">17</span>       <span class="nf">cmp</span> <span class="no">reg4</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x151:</span>   <span class="err">22</span>       <span class="nf">jge</span> <span class="mi">0x11d</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x154:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x158:</span>   <span class="err">18</span>       <span class="nf">jmp</span> <span class="mi">0x15f</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x15b:</span>   <span class="err">1</span>        <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x15f:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg6</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x161:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg5</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x163:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x165:</span>   <span class="err">16</span>       <span class="nf">pop</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x167:</span>   <span class="err">27</span>       <span class="nf">ret</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0xf1</span><span class="p">(</span><span class="n">reg1</span><span class="p">,</span><span class="n">reg2</span><span class="p">,</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">reg1</span><span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">reg1</span> <span class="o">&gt;</span> <span class="mi">7</span> <span class="ow">or</span> <span class="n">reg2</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">reg2</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xe</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg3</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0x70</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg3</span> <span class="o">+=</span> <span class="n">reg7</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">reg3</span><span class="o">==</span><span class="n">reg1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">reg3</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0x80</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">reg3</span> <span class="o">+=</span> <span class="n">reg8</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">reg3</span><span class="o">==</span><span class="n">reg2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">+=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span>
</span></span></code></pre></div><p>Cuối cùng là hàm main:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-asm" data-lang="asm"><span class="line"><span class="cl"><span class="nl">L_0x0:</span>   <span class="err">1</span>          <span class="nf">mov</span> <span class="no">reg0</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x4:</span>   <span class="err">1</span>          <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x70</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x8:</span>   <span class="err">1</span>          <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc:</span>   <span class="err">25</span>         <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf:</span>   <span class="err">2</span>          <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x12:</span>   <span class="err">25</span>        <span class="nf">mov</span> <span class="no">WORD</span> <span class="p">[</span><span class="no">reg1</span><span class="p">],</span> <span class="no">reg0</span>
</span></span><span class="line"><span class="cl"><span class="na">...</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x96:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg7</span><span class="p">,</span> <span class="mi">0x2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x9a:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg8</span><span class="p">,</span> <span class="mi">0x6</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0x9e:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x168</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xa1:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg3</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xa5:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xa9:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg3</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xac:</span>   <span class="err">4</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">BYTE</span> <span class="no">mem</span><span class="p">[</span><span class="no">reg1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xaf:</span>   <span class="err">0</span>         <span class="nf">mov</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xb2:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xb6:</span>   <span class="err">14</span>        <span class="nf">shr</span> <span class="no">reg2</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xb9:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0xf</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xbd:</span>   <span class="err">11</span>        <span class="nf">and</span> <span class="no">reg1</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc0:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0xf1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc3:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x0</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xc7:</span>   <span class="err">17</span>        <span class="nf">cmp</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xca:</span>   <span class="err">19</span>        <span class="nf">je</span> <span class="mi">0xed</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xcd:</span>   <span class="err">0</span>         <span class="nf">mov</span> <span class="no">reg7</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xd0:</span>   <span class="err">0</span>         <span class="nf">mov</span> <span class="no">reg8</span><span class="p">,</span> <span class="no">reg2</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xd3:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x18c</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xd6:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg4</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xda:</span>   <span class="err">17</span>        <span class="nf">cmp</span> <span class="no">reg0</span><span class="p">,</span> <span class="no">reg4</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xdd:</span>   <span class="err">19</span>        <span class="nf">je</span> <span class="mi">0xed</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xe0:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x168</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xe3:</span>   <span class="err">1</span>         <span class="nf">mov</span> <span class="no">reg1</span><span class="p">,</span> <span class="mi">0x1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xe7:</span>   <span class="err">2</span>         <span class="nf">add</span> <span class="no">reg3</span><span class="p">,</span> <span class="no">reg1</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xea:</span>   <span class="err">18</span>        <span class="nf">jmp</span> <span class="mi">0xa5</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xed:</span>   <span class="err">26</span>        <span class="nf">call</span> <span class="mi">0x1ac</span>
</span></span><span class="line"><span class="cl"><span class="nl">L_0xf0:</span>   <span class="err">23</span>        <span class="nf">final</span> <span class="no">check</span> <span class="c1">;(reg0==1)?(WIN:LOST)
</span></span></span></code></pre></div><p>Sau khi gom tất cả lại, ta có code chương trình như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">mem</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0x168</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg3</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">reg8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg3</span> <span class="o">=</span> <span class="n">reg3</span><span class="o">|</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">reg7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">reg8</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0x18c</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg1</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">reg8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">reg1</span><span class="o">&gt;&gt;</span><span class="n">reg7</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0x1ac</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xa8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg4</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0xa0</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">+=</span> <span class="n">reg4</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="mh">0x7f8</span> <span class="ow">and</span> <span class="n">reg7</span><span class="o">==</span><span class="mi">7</span> <span class="ow">and</span> <span class="n">reg8</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func_0xf1</span><span class="p">(</span><span class="n">reg1</span><span class="p">,</span><span class="n">reg2</span><span class="p">,</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">reg1</span><span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">reg1</span> <span class="o">&gt;</span> <span class="mi">7</span> <span class="ow">or</span> <span class="n">reg2</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">reg2</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0xe</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg3</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0x70</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg3</span> <span class="o">+=</span> <span class="n">reg7</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">reg3</span><span class="o">==</span><span class="n">reg1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">reg3</span> <span class="o">=</span> <span class="n">mem</span><span class="p">[</span><span class="mh">0x80</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">reg3</span> <span class="o">+=</span> <span class="n">reg8</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">reg3</span><span class="o">==</span><span class="n">reg2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">+=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">mem</span><span class="p">[</span><span class="mh">0x70</span><span class="p">:</span><span class="mh">0x7e</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl">    <span class="n">mem</span><span class="p">[</span><span class="mh">0x80</span><span class="p">:</span><span class="mh">0x8e</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl">    <span class="n">reg7</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">reg8</span> <span class="o">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">    <span class="n">func_0x168</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg2</span> <span class="o">=</span> <span class="n">b</span><span class="o">&gt;&gt;</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg1</span> <span class="o">=</span> <span class="n">b</span><span class="o">&amp;</span><span class="mh">0xf</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">func_0xf1</span><span class="p">(</span><span class="n">reg1</span><span class="p">,</span><span class="n">reg2</span><span class="p">,</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span> <span class="o">=</span> <span class="n">reg1</span><span class="p">,</span><span class="n">reg2</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">func_0x18c</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">func_0x168</span><span class="p">(</span><span class="n">reg7</span><span class="p">,</span><span class="n">reg8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">func_0x1ac</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">exit</span><span class="p">()</span>
</span></span></code></pre></div><h2 id="solving">
<a class="header-anchor" href="#solving"></a>
Solving
</h2><p>Tới đây việc cần làm là suy nghĩ xem liệu đây chính xác là gì?</p>
<p>Sau quá trình nghiên cứu thì chính xác là ta có 1 ma trận 8x8 nhưng ở dưới dạng bit, nghĩa là 64 bit.</p>
<p><img src="https://hackmd.io/_uploads/SybD4-S56.png" alt="image"></p>
<p>Việc tiếp theo là input của mình sẽ làm thay đổi các bit trong ma trận này, không được step trên những bit đã bật rồi.</p>
<p>Khi mà ta bật được tất cả các bit trong ma trận (sum = 0x7f8 = 2040) thì sẽ chiến thắng và có flag.</p>
<p>Tất cả điều này làm mình liên tưởng đến 1 trò thú vị trong cờ vua, đó chính là mã đi tuần:</p>
<p><a href="https://vi.wikipedia.org/wiki/B%C3%A0i_to%C3%A1n_m%C3%A3_%C4%91i_tu%E1%BA%A7n">https://vi.wikipedia.org/wiki/B%C3%A0i_to%C3%A1n_m%C3%A3_%C4%91i_tu%E1%BA%A7n</a>
<a href="https://en.wikipedia.org/wiki/Knight%27s_tour">https://en.wikipedia.org/wiki/Knight%27s_tour</a></p>
<p><img src="https://hackmd.io/_uploads/B18aVbHqa.png" alt="image"></p>
<p>Tóm lại là trong bàn cờ thì quân mã có nước đi rất thú vị và nó có thể đi hết bàn cờ mà không đi đè lên nước cũ. Ta có thể chọn 2 điểm bắt đầu và kết thúc cho quân mã và tìm ra được đường đi hợp lệ.</p>
<p>Chính xác thì các giá trị được lưu dưới đây là các nước đi hợp lệ của quân mã:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mem[0x70:0x7e] = [1,1,2,2,-1,-1,-2,-2,...] 
</span></span><span class="line"><span class="cl">mem[0x80:0x8e] = [2,-2,1,-1,2,-2,1,-1,...] 
</span></span></code></pre></div><p>Ta có hàm <code>func_0x168</code> là hàm đánh dấu nước đi, <code>func_0xf1</code> là kiểm tra nước đi có hợp lệ, <code>func_0x1ac</code> sẽ kiểm tra bàn cờ và đưa ra flag cuối cùng.
Với input ta có thì 4 bit đầu và 4 bit cuối là toạ độ của nước đi tiếp theo.</p>
<p>Tới đây, ta chỉ cần giải quyết bài toán mã đi tuần nữa là tìm được flag, có 2 hướng giải:</p>
<ul>
<li>Làm tay, vì nó có thủ thuật nên tìm ra đường đi cũng nhanh</li>
<li>Code dùng thuật toán, mình đã thử dùng bfs/dfs để tìm đường đi, tuy nhiên nó chỉ áp dụng được với điểm kết thúc bất kì, không được chọn trước điểm kết thúc như trong chương trình (7,2).</li>
</ul>
<p>Trong trường hợp cấp bách mình đã làm tay theo như <a href="https://youtu.be/3Xoes1PFTZU">video này</a> đã hướng dẫn, ta có điểm bắt đầu và kết thúc như bên dưới:</p>
<p><img src="https://hackmd.io/_uploads/HJt9wWSqT.png" alt="image"></p>
<p>Việc của mình chỉ là cho quân mã đi hết lần lượt từng chuỗi màu tương ứng với điểm bắt đầu và cho đi vào chuỗi màu có chứa điểm kết thúc sau cùng.</p>
<p><img src="https://hackmd.io/_uploads/Hyg4YZS5p.png" alt="image">
<img src="https://hackmd.io/_uploads/Hyqk9bHqp.png" alt="image"></p>
<p>Việc này không tốn thời gian, quá nhiều. Từ đây ta chỉ cần convert thành các nước đi hợp lệ rồi gửi cho chương trình thôi.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">chess</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">39</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">58</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">21</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">64</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">41</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">56</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">19</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">47</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">flat</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">chess</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">flat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">to_send</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">65</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">flat</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sus&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pos</span> <span class="o">=</span> <span class="n">flat</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="o">%</span><span class="mi">8</span><span class="p">,</span><span class="n">pos</span><span class="o">//</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">to_send</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">y</span><span class="o">&lt;&lt;</span><span class="mi">4</span><span class="p">)</span><span class="o">|</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">to_send</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">to_send</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">to_send</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./rust_vm&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;139.162.1.95&#39;</span><span class="p">,</span><span class="mi">31337</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">to_send</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><p><img src="https://hackmd.io/_uploads/r1Uc3ZS9a.png" alt="image"></p>
<p>Flag: <code>TetCTF{TheRe_i$_4_KNighT_iN$iD3_VirTu41_w0RLd}</code></p>
<h2 id="bonus">
<a class="header-anchor" href="#bonus"></a>
Bonus
</h2><p>Ngoài cách giải tay thì các bạn có thể dùng z3 để tìm, cách này được cung cấp bởi <code>@d4rkn19ht</code>, một coder chân chính.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">z3</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">WARNING</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[93m&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">OKGREEN</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[92m&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">ENDC</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0m&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#WARNING: This script works but it take hours to just find the path, so dont use this. </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dx</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">dy</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_board</span><span class="p">(</span><span class="n">boardsize</span><span class="p">,</span> <span class="n">trc</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;|&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">trc</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span><span class="si">:</span><span class="s2">&gt;2</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># implementation for 8x8 chessboard</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">solving</span><span class="p">(</span><span class="n">boardsize</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># IDEA: </span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Create an arr[], arr[i], with i - position on chess board (but in 1 dimension)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># arr[i] : the order when knight move to position i</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># adding constrain to each cell arr[i] (arr[j] = arr[i] + 1, with j to i by moving knight)</span>
</span></span><span class="line"><span class="cl">    <span class="n">in_board</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">boardsize</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span><span class="o">&lt;</span><span class="n">boardsize</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">Int</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Distinct</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span> <span class="o">**</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">0</span><span class="o">&lt;=</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">boardsize</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">in_one_of</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">cond</span> <span class="o">=</span> <span class="n">BoolVal</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cond</span> <span class="o">=</span> <span class="n">Or</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">i</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">cond</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">#define random startpoint, as arr[startpoint] = 0</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># startx = randint(0, 7)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># starty = randint(0, 7)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># solver.add(arr[startx * 8 + starty] == 0)</span>
</span></span><span class="line"><span class="cl">    <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">]</span> <span class="o">==</span> <span class="n">boardsize</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">boardsize</span> <span class="o">**</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="n">start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">//</span> <span class="n">boardsize</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">boardsize</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">ny</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">in_board</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">nx</span> <span class="o">*</span> <span class="n">boardsize</span> <span class="o">+</span> <span class="n">ny</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">        <span class="n">solver</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">in_one_of</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tmp</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">check</span><span class="p">()</span> <span class="o">==</span> <span class="n">sat</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">OKGREEN</span> <span class="o">+</span> <span class="s2">&#34;FOUND solution&#34;</span> <span class="o">+</span> <span class="n">ENDC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(solver.model())</span>
</span></span><span class="line"><span class="cl">        <span class="n">tr</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span> <span class="o">*</span> <span class="n">boardsize</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boardsize</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">tr</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">boardsize</span> <span class="o">+</span> <span class="n">j</span><span class="p">]]</span><span class="o">.</span><span class="n">as_long</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">print_board</span><span class="p">(</span><span class="n">boardsize</span><span class="p">,</span> <span class="n">tr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">WARNING</span> <span class="o">+</span> <span class="s2">&#34;NO soulution found&#34;</span> <span class="o">+</span> <span class="n">ENDC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># raise Exception()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">solving</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="https://hackmd.io/_uploads/H1nJR-Hqp.png" alt="image"></p>
<p>Quá Vjp.👍</p>
<p><img src="https://hackmd.io/_uploads/rJaKAWrc6.png" alt="image"></p>
<h2 id="conclusion">
<a class="header-anchor" href="#conclusion"></a>
Conclusion
</h2><p>Đây là một bài khônng quá khó, hay nhiều technique nhưng vẫn rất hay, cảm ơn tác giả.</p>

      
    </div>
    <footer class="article-footer">
      
        






<blockquote class="article-copyright">
  
    <p><strong><span class="icon-user icon"></span>Author：</strong>Le Phu Duc @ You just landed on Jinn&#39;s site, let&#39;s find out..</p>
  
  
  
    <p><strong><span class="icon-pencil icon"></span>Article title：</strong>TetCTF 2024</p>
  
  
    <p><strong><span class="icon-calendar icon"></span>Publication time：</strong>2024-01-29 00:00:00</p>
  
  
  
    <p>
      <strong><span class="icon-copyright icon"></span>Copyright Noice：</strong>All articles on this blog, unless otherwise stated, are licensed under
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"
        ><span class="icon-creative-commons"></span>BY-NC-SA</a
      >
      the license agreement. Please credit the source when sharing.！
    </p>
    <span class="icon-creative-commons article-copyright-bg"></span>
  
</blockquote>

      

      
        <div class="sponsor-wrapper">
  <div class="sponsor-button-wrapper">
    <div class="sponsor-icon rotate"></div>
    <div class="sponsor-title">Sponsor</div>
    <div class="sponsor-icon rotate"></div>
  </div>
  <div class="sponsor-tip">Please buy author a cup of coffee!</div>
  
    <div class="sponsor-qr">
      
        <div class="sponsor-qr-image-wrapper">
          <img src="/images/bmc_qr_lephuduc.png" alt="buymeacoffee.com/lephuduc" width="200" />
          <p class="sponsor-qr-name">buymeacoffee.com/lephuduc</p>
        </div>
      
    </div>
  
</div>
      

      
        

<div class="share-wrapper">
  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:1313/post/tetctf-2024/" target="_blank" rel="noopener noreferrer" title="TetCTF 2024">
      <div class="share-icon icon icon-facebook">
        
      </div>
    </a>
  
    <a href="https://twitter.com/intent/tweet?url=http://localhost:1313/post/tetctf-2024/&amp;text=TetCTF%202024&amp;via=http://localhost:1313/" target="_blank" rel="noopener noreferrer" title="TetCTF 2024">
      <div class="share-icon icon icon-twitter">
        
      </div>
    </a>
  
    <a href="https://www.linkedin.com/shareArticle?url=http://localhost:1313/post/tetctf-2024/&amp;title=TetCTF%202024&amp;summary=Writeup%20for%20TetCTF%202024&amp;mini=true&amp;ro=true" target="_blank" rel="noopener noreferrer" title="TetCTF 2024">
      <div class="share-icon icon icon-linkedin">
        
      </div>
    </a>
  
    <a href="https://www.reddit.com/submit?url=http://localhost:1313/post/tetctf-2024/&amp;title=TetCTF%202024" target="_blank" rel="noopener noreferrer" title="TetCTF 2024">
      <div class="share-icon icon icon-reddit">
        
      </div>
    </a>
  
</div>
      

      

      

      

      

      
      <ul class="article-tag-list" itemprop="keywords">
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/reverse"
        rel="tag"
        >REVERSE</a
      >
    </li>
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/vietnamese"
        rel="tag"
        >VIETNAMESE</a
      >
    </li>
  
</ul>

    </footer>
  </div>
  
    
  <nav
    id="article-nav"
    data-aos="fade-up"
  >
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          <img
            data-src="/images/post_covers/cddc2023.jpeg"
            data-sizes="auto"
            alt="CDDC 2023"
            class="lazyload"
          />
        
        <a href="http://localhost:1313/post/cddc2023/"></a>
        <div class="article-nav-caption">Older</div>
        <h3 class="article-nav-title">
          
            CDDC 2023
          
        </h3>
      </div>
    

    
      <div class="article-nav-link-wrap article-nav-link-right">
        
          <img
            data-src="/images/post_covers/midnightsun2024-ori.jpeg"
            data-sizes="auto"
            alt="MidnightSun CTF 2024"
            class="lazyload"
          />
        
        <a href="http://localhost:1313/post/midnightsun-2024/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            MidnightSun CTF 2024
          
        </h3>
      </div>
    
  </nav>


  
</article>










</section>
        </div>
        
        
        



  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  



<footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    <div>
      <span class="icon-copyright"></span>
      2022 -
      2025
      <span class="footer-info-sep rotate"></span>
      Le Phu Duc
    </div>
    
    
    
      <div>
        <span class="icon-brush"
          >&nbsp;
            55.1k
          </span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;
          
          

          04:28
        </span>
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar">
        <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#binary">Binary</a></li>
    <li><a href="#writing-disassembler">Writing disassembler</a></li>
    <li><a href="#analyzing">Analyzing</a></li>
    <li><a href="#solving">Solving</a></li>
    <li><a href="#bonus">Bonus</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
  </div>
</div>
      </div>
      <div class="sidebar-common-sidebar hidden">
        
<div class="sidebar-author">
  <img
    data-src="/avatar/shiba.jpg"
    data-sizes="auto"
    alt="Le Phu Duc"
    class="lazyload"
  />
  <div class="sidebar-author-name">Le Phu Duc</div>
  <div class="sidebar-description">a.k.a Jinn</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">18</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      2
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">7</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-discord sidebar-social-icon">
      <a
        href="https://discordapp.com/users/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="discord"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-facebook sidebar-social-icon">
      <a
        href="https://www.facebook.com/lephuduc0309"
        itemprop="url"
        target="_blank"
        aria-label="facebook"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a
        href="https://github.com/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="github"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-instagram sidebar-social-icon">
      <a
        href="https://www.instagram.com/le.phuduc"
        itemprop="url"
        target="_blank"
        aria-label="instagram"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-linkedin sidebar-social-icon">
      <a
        href="https://www.linkedin.com/in/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="linkedin"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-twitter sidebar-social-icon">
      <a
        href="https://twitter.com/lephuduck"
        itemprop="url"
        target="_blank"
        aria-label="twitter"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

      </div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/reimu.png" />
        </div>
      </div>
    
    






  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    
    
    
    
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"
  ></script>




  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    
    
    
    
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"
  ></script>









  
      
      <script src="/js/main.js" ></script>
      



  





  
      
      <script src="/js/aos.js" ></script>
      

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script>








  
      
      <script src="/js/pjax_main.js" data-pjax></script>
      



  <script>
    var ALGOLIA_CONFIG = {
      logo: '\/images\/algolia_logo.svg',
      algolia: {
        applicationID: "",
        apiKey: "",
        indexName: "",
        hits: {
          "per_page": parseInt("10")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果（用时 ${time} ms）"
        }
      }
    };
  </script>
  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"
    defer
    
    
    
    integrity="sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S&#43;jQz7ZBtQXnsXmD&#43;9jDOOY4cL6dCPzlrk" crossorigin="anonymous"
  ></script>


  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"
    defer
    
    
    
    integrity="sha384-hHJCflT4KBLQyHfKO9vpstIcFKn/Y&#43;KHTORelMMEn7mOp2AVPp&#43;7fr03dLgZiV3J" crossorigin="anonymous"
  ></script>


  





  
      
      <script src="/js/algolia_search.js" ></script>
      




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/mouse-firework@0.1.0/dist/index.umd.js"
    
    
    
    
    integrity="sha384-KM6i7tu43nYd6e0beIljxHMC5tZc58XBDu7pPA58w50h18Jsx7gLdimfS09RXlKv" crossorigin="anonymous"
  ></script>


<script>
  if (window.firework) {
    const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"#c0971d\",\"#caa02f\",\"#d4aa40\",\"#ddbb62\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"#f4e74d\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
    options.excludeElements = options.excludeelements;
    delete options.excludeelements;
    window.firework(options);
  }
</script>



  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/theme-shokax-pjax@0.0.3/dist/index.umd.js"
    
    
    
    
    integrity="sha384-xneY1WY8hOfUzswrE4CrYq35N4BdVcxqxwHPr9zawE/jMSCxD&#43;jAPU55x/jj3wlf" crossorigin="anonymous"
  ></script>


  <script>
    function loadScripts(scripts, index) {
      if (index < scripts.length) {
        const script = scripts[index];
        const src = script.getAttribute('src');

        const loadScript = (scriptContent) => {
          return new Promise((resolve, reject) => {
            const scriptElement = document.createElement('script');
            if (script.type) {
              scriptElement.type = script.type;
            }
            if (script.src) {
              scriptElement.src = script.src;
              scriptElement.onload = resolve;
              scriptElement.onerror = reject;
            }
            if (scriptContent) {
              scriptElement.text = scriptContent;
            }
            document.head.appendChild(scriptElement);
            if (!script.src) {
              resolve();
            }
          })
          
        }

        ;(src ? loadScript() : loadScript(script.text))
          .then(() => loadScripts(scripts, index + 1))
          .catch(error => {
            console.error(`Failed to load script: ${src || 'inline script'}`, error);
            loadScripts(scripts, index + 1);
          });
      }
    }
    window.Pjax &&
      new window.Pjax({
        selectors: [
          "#header>img",
          "#header>picture",
          "head title",
          "#header-title",
          "#subtitle-wrap",
          "#main",
          "#content",
          ".sidebar-widget",
          ".sidebar-wrapper",
          "#mobile-nav",
          "#lazy-script",
        ],
        switches: {
          "#content": function(oldEl, newEl) {
            
            oldEl.className = newEl.className;
            this.onSwitch();
          },
          "#header-title": Pjax.switches.outerHTML,
          "#subtitle-wrap": Pjax.switches.outerHTML,
          "#main": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.outerHTML = newEl.outerHTML;
            this.onSwitch();
          },
          "#mobile-nav": Pjax.switches.outerHTML,
          "#lazy-script": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.innerHTML = newEl.innerHTML;
            this.onSwitch();
          },
        },
        cacheBust: false,
      });
  </script>
  





  
      
      <script src="/js/pjax.js" ></script>
      







<div id="lazy-script">
  <div>
    
      
      
        
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Le Phu Duc",
          title: "TetCTF 2024",
          url: "http:\/\/localhost:1313\/post\/tetctf-2024\/",
          description: "Writeup for TetCTF 2024",
          cover: "http:\/\/localhost:1313\/images\/post_covers\/tetctf2024.jpeg",
        };
      </script>
    
    
    
      





  
      
      <script src="/js/insert_highlight.js" data-pjax></script>
      

      
      
      
      
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;

        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      












      
    
    
  </div>
</div>




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    
    async
    
    
    integrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"
  ></script>





  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for (let registration of registrations) {
          registration.unregister();
        }
      });
    }
  </script>





  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.js"
    
    
    
    
    integrity="sha384-gdGYZwHnfJM54evoZhpO0s6ZF5BQiybkiyW7VXr&#43;h5UfruuRL/aORyw&#43;5&#43;HZoU6e" crossorigin="anonymous"
  ></script>


  
    <script>
      const ap = new APlayer({
          theme: "var(--color-link)",
          container: document.getElementById('aplayer'),
          audio: JSON.parse("[{\"artist\":\"Lady Gaga, Bruno Mars\",\"cover\":\"/images/song_covers/die_with_a_smile.jpg\",\"lrc\":\"/songs/die_with_a_smile.lrc\",\"name\":\"Die With A Smile\",\"url\":\"/songs/die_with_a_smile.mp3\"},{\"artist\":\"NewJeans (뉴진스)\",\"cover\":\"/images/song_covers/ditto.jpg\",\"lrc\":\"/songs/ditto.lrc\",\"name\":\"Ditto\",\"url\":\"/songs/ditto.mp3\"},{\"artist\":\"Goose house\",\"cover\":\"/images/song_covers/hikarunara.jpg\",\"lrc\":\"/songs/hikarunara.lrc\",\"name\":\"光るなら\",\"url\":\"/songs/hikarunara.mp3\"}]") || [],
          fixed:  null  || false,
          autoplay:  false  || false,
          loop: 'all' || 'all',
          order: '' || 'list',
          preload: '' || 'auto',
          volume:  null  || 0.7,
          mutex:  null  || true,
          listFolded:  false  || false,
          lrcType:  3  || 0,
      });
    </script>
  



  </body>
</html>
