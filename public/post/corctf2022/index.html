<!doctype html>
<html
  lang="en-us" 
  
    data-theme-mode="true"
  
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>







  

<title>
  CORCTF 2022 | Le Phu Duc
</title>
<meta
  name="description"
  content="Writeup for CORCTF 2022"
/>



  <script>
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "true");
</script>


  
<script src="https://www.googletagmanager.com/gtag/js?id=true"></script>
<script data-pjax>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }

  gtag('js', new Date());

  gtag('config', 'true');
</script>








<script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"clipboard\":{\"copyright\":{\"content\":\"All articles in this blog are licensed under BY-NC-SA unless otherwise stated. Please indicate the source when reprinting!\",\"count\":50,\"enable\":false},\"fail\":\"Failed to copy (ﾟ⊿ﾟ)ﾂ\",\"success\":\"Copied\"},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_0khxww3tj3q9\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":\"This article was last updated on {time}. Please note that the content may have changed.\"}}");
</script>











  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  
    
  

  
  
  


<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cUbuntu%20Mono:400,400italic,700,700italic%7cSource%20Code%20Pro:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7cUbuntu%20Mono:400,400italic,700,700italic%7cSource%20Code%20Pro:400,400italic,700,700italic%7cJetBrains%20Mono:400,400italic,700,700italic&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>






  <link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  />








<link rel="shortcut icon" href="/favicon/favicon.ico">







 <link rel="stylesheet" href="/css/main.css" />





  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />






  <link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css"
    onload="this.onload=null;this.rel='stylesheet'"
  />








  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    
    
    
    
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"
  ></script>





  


  <link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css" />








  <link rel="stylesheet" href="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.css" />



  </head>
  <body>
    

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        
<div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe632;
          
        </div>
        <a class="main-nav-link" href="/">Home</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe628;
          
        </div>
        <a class="main-nav-link" href="/about">About</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe604;
          
        </div>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class='main-nav-icon icon '>
          
            &#xe621;
          
        </div>
        <a class="main-nav-link" href="/achievements">Achievements</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
    
      <a id="nav-search-btn" class="nav-icon popup-trigger" title="Search"></a>
    
  </nav>
</div>
<header id="header">
  
    
    <picture></picture>
      <img fetchpriority="high" src="/images/post_covers/corctf2022.jpeg" alt="CORCTF 2022">
    
  

  <div id="header-outer">
    <div id="header-title">
      
        
        
          
        
  
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">CORCTF 2022</h1>
          </a>
        
      
  
      
        
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>
        <div id="content"
          class="sidebar-left"
            >
          <aside id="sidebar">
  
    <div id="aplayer" theme="var(--color-link)" data-aos="fade-up"></div>
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    >
      
        <div class="sidebar-toc-sidebar">
          <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#microsoft--linux---127-solves122-points">Microsoft ❤️ Linux - 127 solves/122 points</a></li>
    <li><a href="#turbocrab---57-solves154-points">turbocrab - 57 solves/154 points</a></li>
    <li><a href="#msfrob---44-solves170-points">msfrob - 44 solves/170 points</a></li>
    <li><a href="#hackermans-dungeon---8-solves--362-points">hackermans dungeon - 8 solves / 362 points</a></li>
  </ul>
</nav>
  </div>
</div>
        </div>
        <div class="sidebar-common-sidebar hidden">
          
<div class="sidebar-author">
  <img
    data-src="/avatar/shiba.jpg"
    data-sizes="auto"
    alt="Le Phu Duc"
    class="lazyload"
  />
  <div class="sidebar-author-name">Le Phu Duc</div>
  <div class="sidebar-description">a.k.a Jinn</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">19</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      2
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">9</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-discord sidebar-social-icon">
      <a
        href="https://discordapp.com/users/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="discord"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-facebook sidebar-social-icon">
      <a
        href="https://www.facebook.com/lephuduc0309"
        itemprop="url"
        target="_blank"
        aria-label="facebook"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a
        href="https://github.com/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="github"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-instagram sidebar-social-icon">
      <a
        href="https://www.instagram.com/le.phuduc"
        itemprop="url"
        target="_blank"
        aria-label="instagram"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-linkedin sidebar-social-icon">
      <a
        href="https://www.linkedin.com/in/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="linkedin"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-twitter sidebar-social-icon">
      <a
        href="https://twitter.com/lephuduck"
        itemprop="url"
        target="_blank"
        aria-label="twitter"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

        </div>
      

      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  <div class="sidebar-widget">
    
  </div>
</aside>

          <section id="main">
  <article
  class="h-entry article"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta">
      <div class="article-date">
  <a
    href="http://localhost:1313/post/corctf2022/"
    class="article-date-link"
    data-aos="zoom-in"
  >
    <time datetime="2022-06-28 00:00:00 &#43;0000 UTC" itemprop="datePublished"
      >2022-06-28</time
    >
    <time style="display: none;" id="post-update-time"
      >2022-06-28</time
    >
  </a>
</div>

      <div class="article-category">
  
    <a
      class="article-category-link"
      href="/categories/writeup"
      data-aos="zoom-in"
      >WRITEUP</a
    >
  
</div>

    </div>
    <div class="hr-line"></div>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h2 id="microsoft--linux---127-solves122-points">
<a class="header-anchor" href="#microsoft--linux---127-solves122-points"></a>
Microsoft ❤️ Linux - 127 solves/122 points
</h2><blockquote>
<p><strong>Description:</strong>
Microsoft&rsquo;s latest addition to the world of Open Source: a flag checker&hellip;
<strong>Attachment file:</strong>
<a href="https://static.cor.team/uploads/646804dc1464496e49422efa4ca83cf62f82f080e3d62a40f2188c97740d042d/m%3C3l.exe">m&lt;3l.exe</a></p></blockquote>
<p>Thử check file với DiE:</p>
<p><img src="https://i.imgur.com/mZlQRYY.png" alt=""></p>
<p>Thì mình phát hiện nó là file elf nhưng mà đuôi nó là exe:)))</p>
<p>Thử setup và chạy trên linux:</p>
<p><img src="https://i.imgur.com/OnntyK3.png" alt=""></p>
<p>Và tất nhiên là nó không chạy trên windows như thường được, thử dùng IDA để load file:</p>
<p><img src="https://i.imgur.com/PGlnKhC.png" alt=""></p>
<p>Nó dùng thư viện <code>elf.dll</code>, cái này mình cũng mới nghe và cũng không có nhiều kiến thức về nó lắm, mình cũng không thấy nhiều tài liệu về cái này và hiện tại chưa cần tới nên tạm thời bỏ qua.</p>
<p>Đoạn code ban đầu khá là ngắn:</p>
<p><img src="https://i.imgur.com/F74b9UO.png" alt=""></p>
<p>Cơ bản thì đoạn này nó sẽ lấy input của mình lưu vào <code>byte_100111</code> sau đó có 1 vòng lặp 18 lần dùng để lấy từng kí tự input của mình, sau đó rol 0xd bits và compare với byte có sẵn <code>byte_100210</code>. Flow khá ngắn gọn và dễ hiểu.</p>
<p><img src="https://i.imgur.com/2CrKQ5V.png" alt=""></p>
<p>Sau khi kiểm tra thì nó có thể in ra <code>Incorect :(</code> hoặc là <code>$Well done! Sadly, Microsoft has embraced, extended and extinguished the other half of the flag :(</code>&hellip;</p>
<p>Về phần data có sẵn <code>(flag_encrypted)</code> thì nó sẽ trông như thế này:</p>
<p><img src="https://i.imgur.com/hJVU9u3.png" alt=""></p>
<p>Tuy nhiên theo mình thấy thì nó là 36 byte chứ không phải là 18 bytes, tạm thời cứ lấy luôn.</p>
<p>Dùng <code>get_bytes(0x100210,36)</code> để lấy 36 bytes từ IDA:</p>
<p><img src="https://i.imgur.com/4gnDTcy.png" alt=""></p>
<p>Với 18 bytes đầu thì có thể dễ dàng viết script để rev lại:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">ror</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;l</span><span class="se">\xed</span><span class="s1">Nl</span><span class="se">\x8e\xcc</span><span class="s1">of</span><span class="se">\xad</span><span class="s1">LN</span><span class="se">\x86</span><span class="s1">lf</span><span class="se">\x85</span><span class="s1">f</span><span class="se">\x0f\x8e</span><span class="s1">&gt;ci!&gt;Uy&lt;cjx&lt;8e,,&lt;p&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span><span class="o">+=</span><span class="nb">chr</span><span class="p">(</span><span class="n">ror</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></div><p>Và đây là kết quả:</p>
<p><img src="https://i.imgur.com/9ziwm0y.png" alt=""></p>
<p>Có vẻ như khúc sau không đúng cho lắm, thử nhập chạy file và nhập 18 kí tự đầu flag:</p>
<p><img src="https://i.imgur.com/8UtZDXG.png" alt=""></p>
<p>Yes, nó đúng rồi, nhưng phải có đoạn check kiểm tra khúc sau chứ?</p>
<p>Thử tìm lại trong IDA thì mình phát hiện đoạn này khá đáng nghi:</p>
<p><img src="https://i.imgur.com/9SmqC6w.png" alt=""></p>
<p>Bấm &lsquo;c&rsquo; để chuyển data về code thì thu được đoạn code khá tương tự với đoạn trên:</p>
<p><img src="https://i.imgur.com/KVA4smY.png" alt=""></p>
<p>Flow của đoạn này cũng tương tự như đoạn trên tuy nhiên thay vì <code>rol</code> thì nó lại dùng <code>pushf</code> và and,.. Nhưng chung quy thì nó cũng chỉ là một toán tử nào đó, vì một lí do nào đó thì IDA không nhận diện được opcode nên nó đã không hiển thị đầy đủ.</p>
<p>Mình tới đây mình đã thử đoán xem cái này nó đã làm gì với 18 bytes cuối <code>&gt;ci!&gt;Uy&lt;cjx&lt;8e,,&lt;p</code>.Và bởi vì nó là bài rev khá đơn giản nên không cần bruteforce gì cả, mình thấy nó cũng khá dễ đọc nên có thể là <code>+</code>,<code>-</code> hoặc <code>xor</code> thôi, còn về toán hạng thì mình vẫn sử dụng số cũ là <code>0xd</code>.</p>
<p>Vậy nên là lúc dùng phép xor với 0xd thì mình đã tìm được nữa flag cuối:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">last</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&gt;ci!&gt;Uy&lt;cjx&lt;8e,,&lt;p&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">xor</span><span class="p">(</span><span class="n">last</span><span class="p">,</span><span class="mh">0xd</span><span class="p">))</span> <span class="c1">#3nd,3Xt1ngu15h!!1}</span>
</span></span></code></pre></div><p>Kết hợp 2 phần lại ta được flag:</p>
<p>Flag: <code>corctf{3mbr4c3,3xt3nd,3Xt1ngu15h!!1}</code></p>
<h2 id="turbocrab---57-solves154-points">
<a class="header-anchor" href="#turbocrab---57-solves154-points"></a>
turbocrab - 57 solves/154 points
</h2><blockquote>
<p><strong>Description:</strong>
🚀🚀 blazinglyer faster 🚀🚀
SHA256 hash of the flag: <code>dc136f8bf4ba6cc1b3d2f35708a0b2b55cb32c2deb03bdab1e45fcd1102ae00a</code>
<strong>Attachment file:</strong>
<a href="https://static.cor.team/uploads/c151963ea732b096d482896731662b367e7c50b12fc1427d0461319d01bd9a04/turbocrab">turbocrab</a></p></blockquote>
<p>Về cơ bản thì nó chỉ là 1 file ELF bình thường, không packed và check flag:</p>
<p><img src="https://i.imgur.com/OZG0cxf.png" alt=""></p>
<p><img src="https://i.imgur.com/EiN6qAZ.png" alt=""></p>
<p>Load bằng IDA và static analysis thử:</p>
<p><img src="https://i.imgur.com/q0VWZF4.png" alt=""></p>
<p>Vì là viết bằng <code>rust</code> nên là khá loằng ngoằng, vậy nên cách nhanh nhất là kiểm tra trong tab <code>string</code>(tìm đoạn text &ldquo;Flag is incorrect!&rdquo;) để reference tới chổ gọi nó:</p>
<p><img src="https://i.imgur.com/4gKNwGm.png" alt=""></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">void</span><span class="w"> </span><span class="n">__cdecl</span><span class="w"> </span><span class="n">turbocrab</span>::<span class="n">execute_shellcode</span>::<span class="n">h6984ce5848b31780</span><span class="p">(</span><span class="n">__u8_</span><span class="w"> </span><span class="n">shellcode</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">__u8_</span><span class="w"> </span><span class="n">v1</span><span class="p">;</span><span class="w"> </span><span class="c1">// rdi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v2</span><span class="p">;</span><span class="w"> </span><span class="c1">// r15
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v3</span><span class="p">;</span><span class="w"> </span><span class="c1">// rdx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="kt">usize</span><span class="w"> </span><span class="n">v4</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+8h] [rbp-190h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="kt">u8</span><span class="w"> </span><span class="o">*</span><span class="n">v5</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+10h] [rbp-188h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="kt">usize</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+20h] [rbp-178h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+28h] [rbp-170h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+30h] [rbp-168h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="n">dst</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+48h] [rbp-150h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="no">_BYTE</span><span class="w"> </span><span class="n">v10</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span><span class="w"> </span><span class="c1">// [rsp+63h] [rbp-135h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">u8</span><span class="p">,</span><span class="n">alloc</span>::<span class="n">alloc</span>::<span class="n">Global</span><span class="o">&gt;</span><span class="w"> </span><span class="bp">self</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+80h] [rbp-118h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="kt">u8</span><span class="w"> </span><span class="o">*</span><span class="n">v12</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+98h] [rbp-100h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v13</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+A0h] [rbp-F8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">Arguments</span><span class="w"> </span><span class="n">v14</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+A8h] [rbp-F0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">Arguments</span><span class="w"> </span><span class="n">v15</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+D8h] [rbp-C0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__u8_</span><span class="w"> </span><span class="n">v16</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+108h] [rbp-90h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="n">v17</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+118h] [rbp-80h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="o">*</span><span class="n">v18</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+130h] [rbp-68h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v19</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+138h] [rbp-60h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v20</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+140h] [rbp-58h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v21</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+148h] [rbp-50h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="n">v22</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+150h] [rbp-48h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="n">v23</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+158h] [rbp-40h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v24</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+160h] [rbp-38h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v25</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+168h] [rbp-30h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="kt">u8</span><span class="w"> </span><span class="o">*</span><span class="n">v26</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+170h] [rbp-28h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="n">__int64</span><span class="w"> </span><span class="n">v27</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+178h] [rbp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="kt">u8</span><span class="w"> </span><span class="o">*</span><span class="n">v28</span><span class="p">;</span><span class="w"> </span><span class="c1">// [rsp+180h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shellcode</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="n">LL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">mmap</span><span class="p">(</span><span class="mi">0</span><span class="n">LL</span><span class="p">,</span><span class="w"> </span><span class="n">shellcode</span><span class="p">.</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">33</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="n">LL</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dst</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">qmemcpy</span><span class="p">(</span><span class="n">v10</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;R^CRIWJM&lt;6.[5I.G`.C3G3CB5_V?P&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">sizeof</span><span class="p">(</span><span class="n">v10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="n">from_elem</span>::<span class="n">hba0d51ad3cb1207d</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4000</span><span class="n">uLL</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v26</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alloc</span>::<span class="n">vec</span>::<span class="nb">Vec</span><span class="cp">$LT$T$C$A$GT$</span>::<span class="n">as_ptr</span>::<span class="n">h0252951c7d91d004</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v27</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">49602</span><span class="n">LL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v28</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v26</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">49602</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v26</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">49602</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">core</span>::<span class="n">slice</span>::<span class="n">_</span><span class="cp">$LT$impl$u20$$u5b$T$u5d$$GT$</span>::<span class="n">as_ptr</span>::<span class="n">h869fdf96852d8c48</span><span class="p">(</span><span class="n">shellcode</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span>::<span class="n">slice</span>::<span class="n">_</span><span class="cp">$LT$impl$u20$$u5b$T$u5d$$GT$</span>::<span class="n">len</span>::<span class="n">h00af0a2d7a9c0658</span><span class="p">(</span><span class="n">shellcode</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dst</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v24</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">core</span>::<span class="n">intrinsics</span>::<span class="n">copy</span>::<span class="n">h46e3e522e297e890</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span>::<span class="n">slice</span>::<span class="n">_</span><span class="cp">$LT$impl$u20$$u5b$T$u5d$$GT$</span>::<span class="n">len</span>::<span class="n">h00af0a2d7a9c0658</span><span class="p">(</span><span class="n">shellcode</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">mprotect</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v20</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v13</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v1</span><span class="p">.</span><span class="n">data_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v1</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">29</span><span class="n">LL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span>::<span class="n">slice</span>::<span class="n">_</span><span class="cp">$LT$impl$u20$$u5b$T$u5d$$GT$</span>::<span class="n">as_ptr</span>::<span class="n">h869fdf96852d8c48</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v1</span><span class="p">.</span><span class="n">data_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v10</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v1</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">29</span><span class="n">LL</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span>::<span class="n">slice</span>::<span class="n">_</span><span class="cp">$LT$impl$u20$$u5b$T$u5d$$GT$</span>::<span class="n">len</span>::<span class="n">h00af0a2d7a9c0658</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">__int64</span><span class="p">)</span><span class="n">v12</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">__int64</span><span class="w"> </span><span class="p">(</span><span class="n">__fastcall</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="no">_BYTE</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">__int64</span><span class="p">,</span><span class="w"> </span><span class="n">__int64</span><span class="p">,</span><span class="w"> </span><span class="n">core</span>::<span class="n">ffi</span>::<span class="n">c_void</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="kt">usize</span><span class="p">))</span><span class="n">dst</span><span class="p">)(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">v10</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="mi">29</span><span class="n">LL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">v3</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">dst</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">v5</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">v4</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">u8</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">v2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v13</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">v21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v13</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">v13</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">Arguments</span>::<span class="n">new_v1</span>::<span class="n">h610d7aa66ccb1a0c</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">&amp;</span><span class="n">v14</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">(</span><span class="n">___str_</span><span class="p">)</span><span class="n">__PAIR128__</span><span class="p">(</span><span class="mi">1</span><span class="n">LL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">stru_174F78</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">(</span><span class="n">__core</span>::<span class="n">fmt</span>::<span class="n">ArgumentV1_</span><span class="p">)(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">stru_10B240</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">else</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">core</span>::<span class="n">fmt</span>::<span class="n">Arguments</span>::<span class="n">new_v1</span>::<span class="n">h610d7aa66ccb1a0c</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">&amp;</span><span class="n">v15</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">(</span><span class="n">___str_</span><span class="p">)</span><span class="n">__PAIR128__</span><span class="p">(</span><span class="mi">1</span><span class="n">LL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">stru_174F68</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">(</span><span class="n">__core</span>::<span class="n">fmt</span>::<span class="n">ArgumentV1_</span><span class="p">)(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">stru_10B240</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">std</span>::<span class="n">io</span>::<span class="n">stdio</span>::<span class="n">_print</span>::<span class="n">hccc6c4adfff98fee</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">core</span>::<span class="n">ptr</span>::<span class="n">drop_in_place</span><span class="cp">$LT$alloc</span><span class="o">..</span><span class="n">vec</span><span class="o">..</span><span class="nb">Vec</span><span class="cp">$LT$u8$GT$$GT$</span>::<span class="n">h34608ea8b4b90afb</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Tới đây có 1 điểm đáng chú ý là</p>
<p><code>qmemcpy(v10, &quot;R^CRIWJM&lt;6.[5I.G`.C3G3CB5_V?P&quot;, sizeof(v10));</code></p>
<p>nhìn khá giống với đoạn flag encrypted vậy.</p>
<p>Tiếp theo là shellcode được sử dụng khá nhiều</p>
<p><img src="https://i.imgur.com/PnQWrWl.png" alt=""></p>
<p>Và ngoài ra còn biến <code>v13</code> dùng để rẽ nhánh chương trình Xuất ra Correct! hay Incorrect!:</p>
<p><img src="https://i.imgur.com/wNL0YcG.png" alt=""></p>
<p>Và nó được trả về sau khi gọi &ldquo;dst&rdquo;.</p>
<p>Tới đây rất có thể dst này sẽ chứa shellcode là là luồn thực thi chính của chương trình, setup ngay máy ảo, đặt breakpoint và debug file thôi!..</p>
<p><img src="https://i.imgur.com/ADeZrti.png" alt=""></p>
<p>Sau khi tới breakpoint, nhấn <code>f7</code> để step into
xem bên trong &ldquo;dst&rdquo; cũng như là shellcode có gì:</p>
<p><img src="https://i.imgur.com/qJaxteW.png" alt=""></p>
<p>Sau khi chạy tới <code>call    near ptr unk_7F8C04CC62B2</code>, nó bắt mình nhập input, thử nhập &ldquo;abcdefgh&rdquo; cho dễ quan sát</p>
<p>Tới đây có thể thấy được đoạn flag encrypted cũng được load vào, và cả input của mình nữa:</p>
<p><img src="https://i.imgur.com/RPrd0sc.png" alt=""></p>
<p><img src="https://i.imgur.com/eAn2sJf.png" alt=""></p>
<p>Tiếp tục trace và debug, mình biết được flow như sau: Nó lấy từng kí tự của input mình <code>c</code>, sau đó:
<code>c^0x13 - 0x1e</code> và compare với lại từng kí tự của flag encrypted.</p>
<p><img src="https://i.imgur.com/4aGcU2P.png" alt=""></p>
<p>Tới đây thì mình mừng thầm, chỉ cần viết scipt rev lại là ra. Sau đó mình đã dùng python và code thử:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fl</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;R^CRIWJM&lt;6.[5I.G`.C3G3CB5_V?P&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">+=</span><span class="nb">chr</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mh">0x1E</span><span class="p">)</span><span class="o">^</span><span class="mh">0x13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1">#corctf{xIG_j@t_vm_rBvBrs@ngN}</span>
</span></span></code></pre></div><p>Có lẽ đã gần đúng nhưng nhìn không giống flag cho lắm. Tới đây mình đã thử submit và tất nhiên nó sai.</p>
<p>Sau đó mình đã thử rev kĩ lạ chương trình thì thấy một vài chi tiết bị thiếu nhưng khi thử nhập flag vào chương trình thì nó vẫn đúng =&gt; nó không dùng tới những khúc đó, phần rev file coi như xong.</p>
<p><img src="https://i.imgur.com/81RDTMu.png" alt=""></p>
<p>Tuy nhiên vẫn còn 1 thiếu sót là đề cho chúng ta sha256 flag, vậy là có thứ để kiểm chứng, còn về flag thì có thể dễ dàng nhìn thấy một số kí tự nhìn khá là lạ, một số còn lại hầu như chắc chắn đúng:</p>
<p><code>corctf{xIG_j@t_vm_rBvBrs@ngN}</code></p>
<p>Dựa theo flag của bài trước thì có hướng suy nghĩ là có thể những kí tự uppercase và symbol coi như sai, còn từ cuối trong flag có thể dễ đoán là reversing</p>
<p>=&gt; B là chữ i, hoặc cũng có thể là số 1, hoặc là I, thôi cứ đưa vào cho chắc ăn, tương tự với @.</p>
<p>Còn I,G,N tạm thời chưa biết nên là cứ bruteforce, mình đã viết thử script để brute:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">fl</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;R^CRIWJM&lt;6.[5I.G`.C3G3CB5_V?P&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">+=</span><span class="nb">chr</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mh">0x1E</span><span class="p">)</span><span class="o">^</span><span class="mh">0x13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">hashflag</span> <span class="o">=</span> <span class="s2">&#34;dc136f8bf4ba6cc1b3d2f35708a0b2b55cb32c2deb03bdab1e45fcd1102ae00a&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">xflag</span> <span class="o">=</span> <span class="s2">&#34;corctf{xIG_j@t_vm_rBvBrs@ngN}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0xf7</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">G</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0xf7</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,]:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0xf7</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">temp</span> <span class="o">=</span> <span class="n">xflag</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">G</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                    <span class="n">hashed_string</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">hashed_string</span><span class="o">==</span><span class="n">hashflag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#corctf{x86_j1t_vm_r3v3rs1ng?}</span>
</span></span></code></pre></div><p>Flag: <code>corctf{x86_j1t_vm_r3v3rs1ng?}</code></p>
<h2 id="msfrob---44-solves170-points">
<a class="header-anchor" href="#msfrob---44-solves170-points"></a>
msfrob - 44 solves/170 points
</h2><blockquote>
<p><strong>Description:</strong>
6b0a444558474b460a5a58454d584b470a5f5943444d0a444558474b460a4d464348490a4c5f44495e4345445904
<strong>Attachment file:</strong>
<a href="https://static.cor.team/uploads/48fcb317ca7280353ab06e4867f510740046ad9e65eaa9a3fc5e97095fbbf9d7/msfrob">msfrob</a></p></blockquote>
<p>Thử kiểm tra bằng DiE:</p>
<p><img src="https://i.imgur.com/jQ0C2KG.png" alt=""></p>
<p>Vì ban đầu chạy không được nên load bằng IDA để phân tích thử:</p>
<p><img src="https://i.imgur.com/7Y3Qfdp.png" alt=""></p>
<p>Thì ban đầu flow khá dễ hiểu nó sẽ nhận input thông qua agrv và xử lí qua vòng lặp 20 lần, tuy nhiên, các hàm ở vòng lặp này không có tên và cũng không có code, nên mình đoán nó là lấy từ thư viện ra mình. Vậy là trước khi chạy thì mình không biết gì về nó</p>
<p>Đối với mình thì bài này là bài khiến mình mất thời gian nhất =))) Không phải vì bài khó mà là fix cái ubuntu của mình vì khi chạy file nó sẽ như thế này:</p>
<p><img src="https://i.imgur.com/gSy3qho.png" alt=""></p>
<p>Hoặc là như thế này:</p>
<p><img src="https://i.imgur.com/C4dFDZj.png" alt=""></p>
<p>Thì 2 hình ảnh là 2 phiên bản hệ điều hành khác nhau (<code>22.04</code> và <code>18.04</code>, mình cũng đã thử với <code>20.04</code>nhưng cũng tương tự), mình xài WSL nên cũng hay có lỗi vặt. Mình đã thử tìm cách fix trên mạng rất nhiều nhưng nó rất nhức đầu và làm theo cũng không fix được.</p>
<p>Tới đây còn cách duy nhất là mình cài lại 1 ubuntu hoàn toàn mới, rồi từ đó biết mình thiếu cái gì thì cài cái đó.</p>
<p>Cụ thể thì sau khi cài <a href="https://ubuntu.com/download/desktop">Ubuntu</a>, và nó báo mình thiếu thư viện <code>libcrypto.so.1.1</code>, qua 1 thời gian dài tìm hiểu thì mình tìm được cách fix là cài lại toàn bộ openssl theo phiên bản 1.1 như <a href="https://fedingo.com/how-to-install-openssl-in-ubuntu/">link này</a>.</p>
<p>Sau khi fix xong, chạy fix thì nó sẽ trông như thế này:</p>
<p><img src="https://i.imgur.com/au4pQPB.png" alt=""></p>
<p>Nice, giờ thì setup debug để xem nó làm gì thôi.</p>
<p>Trước khi vào vòng lặp thì nó đi qua 2 hàm, nhưng có vẻ 2 hàm này không quan trọng lắm.</p>
<p><img src="https://i.imgur.com/rgwy6Mq.png" alt=""></p>
<p><img src="https://i.imgur.com/m97AUgR.png" alt=""></p>
<p>Tới hàm đầu tiên, mình thử click đúp và trace xem nó là gì thì được kết quả như này:</p>
<p><img src="https://i.imgur.com/YG3Yu9W.png" alt=""></p>
<p>Thì nó là deflate init, search thử <code>deflate</code> trên mạng thì mình biết được nó là compress nhưng thay vì trên file (zip,tar) thì là trên data (compress data).</p>
<p>Tiếp tục làm tương tự với các hàm còn lại, mình đã rename lại gần như toàn bộ và được đoạn code như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_55A613A3B4E1</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">input</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">aes</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">len_out</span><span class="p">;</span> <span class="c1">// [rsp+1Ch] [rbp-894h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">blocksize</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-890h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-88Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">CipherCTX</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-888h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="o">*</span><span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+30h] [rbp-880h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+38h] [rbp-878h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="o">*</span><span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+48h] [rbp-868h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+50h] [rbp-860h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">len_in</span><span class="p">;</span> <span class="c1">// [rsp+58h] [rbp-858h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [rsp+70h] [rbp-840h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+78h] [rbp-838h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [rsp+80h] [rbp-830h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">buf_out</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span> <span class="c1">// [rsp+A0h] [rbp-810h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">buf_in</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// [rsp+4A0h] [rbp-410h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v18</span><span class="p">[</span><span class="mi">1016</span><span class="p">];</span> <span class="c1">// [rsp+4B0h] [rbp-400h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v19</span><span class="p">;</span> <span class="c1">// [rsp+8A8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v19</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">buf_out</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf_out</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="n">buf_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">buf_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">v18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x3F0uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">len_out</span> <span class="o">=</span> <span class="nf">sub_55A613A3B080</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">v18</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_55A613A3B120</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">19</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v14</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v15</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="n">len_out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="n">buf_out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v10</span> <span class="o">=</span> <span class="n">buf_in</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">Deflate_init</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="mh">0xFFFFFFFFLL</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="s">&#34;1.2.12&#34;</span><span class="p">,</span> <span class="mi">112LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">Deflate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v8</span><span class="p">,</span> <span class="mi">4LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">Deflate_end</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">CipherCTX</span> <span class="o">=</span> <span class="nf">CIPHER_CTX_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">aes</span> <span class="o">=</span> <span class="nf">Aes_256_cbc</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nf">Encrypt_init</span><span class="p">(</span><span class="n">CipherCTX</span><span class="p">,</span> <span class="n">aes</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">iv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">EncryptUpdate</span><span class="p">(</span><span class="n">CipherCTX</span><span class="p">,</span> <span class="n">buf_out</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">len_out</span><span class="p">,</span> <span class="n">buf_in</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">len_in</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">EncryptFinal_ex</span><span class="p">(</span><span class="n">CipherCTX</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">buf_out</span> <span class="o">+</span> <span class="n">len_out</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">blocksize</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">CIPHER_CTX_free</span><span class="p">(</span><span class="n">CipherCTX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">len_out</span> <span class="o">+=</span> <span class="n">blocksize</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">sub_55A613A3B0F0</span><span class="p">(</span><span class="n">buf_out</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">byte</span><span class="p">,</span> <span class="mi">352LL</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_55A613A3B040</span><span class="p">(</span><span class="s">&#34;Incorrect :msfrog:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_55A613A3B040</span><span class="p">(</span><span class="s">&#34;Correct :msfrogcircle:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="n">v19</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">result</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">sub_55A613A3B0E0</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Giải thích: Sau nhiều lần debug thì mình biết được <code>input</code> của mình sẽ được deflate (compress) và 16bytes đầu của đoạn compressed_data sẽ được encrypt bằng AES_CBC (với key,iv biết trước, <code>EncryptUpdate()</code>) và hàm <code>Encrypt_final_ex()</code> sẽ encrypt đoạn còn lại của compressed_data và lưu vào ngay sau đoạn đầu tiên.</p>
<p>Như vậy với compressed_data có <code>16 &lt; lenght &lt; 32</code> thì out put được ghi trên buf_out sẽ có lenght bằng 32, ở vòng lặp tiếp theo, nó sẽ lấy 32 byte này compress và lặp lại các bước trong vòng lặp, buf_out lần này sẽ có length là 48&hellip; cho tới khi length = 352 (lặp đủ 20 lần) và thoát khỏi vòng lặp, như vậy nó sẽ được mô phỏng như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">zlib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">byte</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;L</span><span class="se">\xef</span><span class="s1">4</span><span class="se">\xfa\xd1</span><span class="si">%E</span><span class="s1">K</span><span class="se">\xe7\xad\x99\xc4\xb1\xd7\xf6</span><span class="s1">,[</span><span class="se">\xf3\x13\xbf\xcc\x03\x1d\x16\x81\xdb</span><span class="s1">P8</span><span class="se">\xa8\xb6\xdd</span><span class="s1"> </span><span class="se">\x90</span><span class="s1">*n</span><span class="se">\xa2\xef\xfe</span><span class="s1">k</span><span class="se">\x8f\xdb\x80</span><span class="s1">opt</span><span class="se">\xeb</span><span class="s1">}6</span><span class="se">\xe4\xdc\x87\xf3</span><span class="s1"> </span><span class="se">\xeb\xe5\x0f</span><span class="s1">&gt;(5X</span><span class="se">\xad\x07\xd2</span><span class="s1">=</span><span class="se">\xd8</span><span class="s1">]A5^OA</span><span class="se">\x9b\x91\x85\xe1\\\x18\xb8\xf6</span><span class="s1">Z</span><span class="se">\xdf\x08</span><span class="s1">51</span><span class="se">\x04\xd2\xe0</span><span class="s1">Dd</span><span class="se">\xfc\x06\xc6\xd6</span><span class="s1">[</span><span class="se">\x98</span><span class="s1"> O</span><span class="se">\x1c\x1e\xb8</span><span class="s1"> </span><span class="se">\xd5\x9e\xda\x81\xd6</span><span class="s1">6[U`</span><span class="se">\xa8</span><span class="s1">,</span><span class="se">\xf2\xda</span><span class="s1">W</span><span class="se">\x92\xc9\xe0\x14\xf0</span><span class="s1">CK.</span><span class="se">\x11\xd3</span><span class="s1">pg</span><span class="se">\xa8</span><span class="s1">U</span><span class="se">\x08</span><span class="s1">}</span><span class="se">\xc7</span><span class="s1">vOw</span><span class="se">\xe8\xbe\xf3\x19\x04\x84\xb2\xa0</span><span class="s1"> </span><span class="se">\xdc</span><span class="s1">L</span><span class="se">\xd2\xc8\x94\x17\x9b</span><span class="s1">uOx55</span><span class="se">\xe6</span><span class="s1">bt-</span><span class="se">\x0c\xa8</span><span class="s1">4</span><span class="se">\xf1\x90\xa9\xfd</span><span class="s1">Y</span><span class="se">\xd4\xf8</span><span class="s1">$</span><span class="se">\xb9</span><span class="s1">;</span><span class="se">\x94\xbd</span><span class="s1">y</span><span class="se">\xc7</span><span class="s1">x</span><span class="se">\xb9</span><span class="s1">V</span><span class="se">\xc1\xe3\xb6</span><span class="s1">.</span><span class="se">\x17</span><span class="s1">:2</span><span class="se">\xf9</span><span class="s1">NG</span><span class="se">\xf9\t\xc4\xe8\xfa</span><span class="s1">ISj</span><span class="se">\x0b\xb9</span><span class="s1">6</span><span class="se">\x0b</span><span class="s1">+</span><span class="se">\\\xc9\xf3</span><span class="s1">9c</span><span class="se">\xb3\xd1\xac</span><span class="s1">pl</span><span class="se">\xf1</span><span class="s1">FB</span><span class="se">\xbc\x0b\x91</span><span class="s1">:d</span><span class="se">\x95</span><span class="s1">w</span><span class="se">\xec</span><span class="s1">$</span><span class="se">\x01</span><span class="s1">d</span><span class="se">\xd2\x98\xe1\xbf</span><span class="s1">8</span><span class="se">\x17\xd4\xd0</span><span class="s1">9</span><span class="se">\x16\x13\x1d</span><span class="s1">4</span><span class="se">\xa4\x1a\xfa</span><span class="s1">3_</span><span class="se">\x88</span><span class="s1">!</span><span class="se">\xd5\\</span><span class="s1">N</span><span class="se">\xbf</span><span class="s1">3</span><span class="se">\x9d\xe1</span><span class="s1">*</span><span class="se">\xcc</span><span class="s1">G</span><span class="se">\x15\x03\x9d\xa6\x85</span><span class="s1">6-m1</span><span class="se">\x01</span><span class="s1">=</span><span class="se">\x95\x08\xdc</span><span class="s1">r</span><span class="se">\xd3\xf6\xf7</span><span class="s1">e</span><span class="se">\xb7\xc0\x95</span><span class="s1">]</span><span class="se">\xf4\xc9\xa7\xfa\xdc\xef</span><span class="s1">Q6</span><span class="se">\xc1\x1d\xe6\x08\xeb\x8a\xec</span><span class="s1">]</span><span class="se">\xc9</span><span class="s1">Z=</span><span class="se">\xd3\x9a\xa6\xad</span><span class="s1">(</span><span class="se">\x99</span><span class="s1">$</span><span class="se">\x88\x92</span><span class="s1">@-</span><span class="se">\xab\x12</span><span class="s1">Y</span><span class="se">\xf8\x84</span><span class="s1">G</span><span class="se">\xb2\xb9</span><span class="s1">H</span><span class="se">\xf7\x8f\x1e</span><span class="s1">2d</span><span class="se">\xba</span><span class="s1">$</span><span class="se">\xd2</span><span class="s1">=</span><span class="se">\xf3\xc4\x84\xbd\xd2\xe1\x01\x07\xa1</span><span class="s1">v</span><span class="se">\x18</span><span class="s1">E</span><span class="se">\x1e</span><span class="s1">T</span><span class="se">\x91\x93\x11</span><span class="s1">nAT~@</span><span class="se">\xe7\x02</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xd4\xf5\xd9</span><span class="s1">g</span><span class="se">\x15</span><span class="s1">/w</span><span class="se">\x7f</span><span class="s1">l|Fs</span><span class="se">\xf6\xf0\x92\xf0</span><span class="s1">wP;0</span><span class="se">\x0c\x87\x8a\r\x9c\x1d</span><span class="s1">r</span><span class="se">\xa2</span><span class="s1">eF</span><span class="se">\xc8\xdc</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># cipher explain</span>
</span></span><span class="line"><span class="cl"><span class="n">inp</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;corctf</span><span class="si">{abcdefgh}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">buf_out</span> <span class="o">=</span> <span class="n">inp</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">buf_out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span><span class="n">iv</span><span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">first</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">16</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">final</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">16</span><span class="p">:],</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">buf_out</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="n">final</span> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">buf_out</span><span class="p">)</span>
</span></span></code></pre></div><p>Như vậy, có thể dễ dàng rev algo này lại như sau và lấy flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">zlib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">byte</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;L</span><span class="se">\xef</span><span class="s1">4</span><span class="se">\xfa\xd1</span><span class="si">%E</span><span class="s1">K</span><span class="se">\xe7\xad\x99\xc4\xb1\xd7\xf6</span><span class="s1">,[</span><span class="se">\xf3\x13\xbf\xcc\x03\x1d\x16\x81\xdb</span><span class="s1">P8</span><span class="se">\xa8\xb6\xdd</span><span class="s1"> </span><span class="se">\x90</span><span class="s1">*n</span><span class="se">\xa2\xef\xfe</span><span class="s1">k</span><span class="se">\x8f\xdb\x80</span><span class="s1">opt</span><span class="se">\xeb</span><span class="s1">}6</span><span class="se">\xe4\xdc\x87\xf3</span><span class="s1"> </span><span class="se">\xeb\xe5\x0f</span><span class="s1">&gt;(5X</span><span class="se">\xad\x07\xd2</span><span class="s1">=</span><span class="se">\xd8</span><span class="s1">]A5^OA</span><span class="se">\x9b\x91\x85\xe1\\\x18\xb8\xf6</span><span class="s1">Z</span><span class="se">\xdf\x08</span><span class="s1">51</span><span class="se">\x04\xd2\xe0</span><span class="s1">Dd</span><span class="se">\xfc\x06\xc6\xd6</span><span class="s1">[</span><span class="se">\x98</span><span class="s1"> O</span><span class="se">\x1c\x1e\xb8</span><span class="s1"> </span><span class="se">\xd5\x9e\xda\x81\xd6</span><span class="s1">6[U`</span><span class="se">\xa8</span><span class="s1">,</span><span class="se">\xf2\xda</span><span class="s1">W</span><span class="se">\x92\xc9\xe0\x14\xf0</span><span class="s1">CK.</span><span class="se">\x11\xd3</span><span class="s1">pg</span><span class="se">\xa8</span><span class="s1">U</span><span class="se">\x08</span><span class="s1">}</span><span class="se">\xc7</span><span class="s1">vOw</span><span class="se">\xe8\xbe\xf3\x19\x04\x84\xb2\xa0</span><span class="s1"> </span><span class="se">\xdc</span><span class="s1">L</span><span class="se">\xd2\xc8\x94\x17\x9b</span><span class="s1">uOx55</span><span class="se">\xe6</span><span class="s1">bt-</span><span class="se">\x0c\xa8</span><span class="s1">4</span><span class="se">\xf1\x90\xa9\xfd</span><span class="s1">Y</span><span class="se">\xd4\xf8</span><span class="s1">$</span><span class="se">\xb9</span><span class="s1">;</span><span class="se">\x94\xbd</span><span class="s1">y</span><span class="se">\xc7</span><span class="s1">x</span><span class="se">\xb9</span><span class="s1">V</span><span class="se">\xc1\xe3\xb6</span><span class="s1">.</span><span class="se">\x17</span><span class="s1">:2</span><span class="se">\xf9</span><span class="s1">NG</span><span class="se">\xf9\t\xc4\xe8\xfa</span><span class="s1">ISj</span><span class="se">\x0b\xb9</span><span class="s1">6</span><span class="se">\x0b</span><span class="s1">+</span><span class="se">\\\xc9\xf3</span><span class="s1">9c</span><span class="se">\xb3\xd1\xac</span><span class="s1">pl</span><span class="se">\xf1</span><span class="s1">FB</span><span class="se">\xbc\x0b\x91</span><span class="s1">:d</span><span class="se">\x95</span><span class="s1">w</span><span class="se">\xec</span><span class="s1">$</span><span class="se">\x01</span><span class="s1">d</span><span class="se">\xd2\x98\xe1\xbf</span><span class="s1">8</span><span class="se">\x17\xd4\xd0</span><span class="s1">9</span><span class="se">\x16\x13\x1d</span><span class="s1">4</span><span class="se">\xa4\x1a\xfa</span><span class="s1">3_</span><span class="se">\x88</span><span class="s1">!</span><span class="se">\xd5\\</span><span class="s1">N</span><span class="se">\xbf</span><span class="s1">3</span><span class="se">\x9d\xe1</span><span class="s1">*</span><span class="se">\xcc</span><span class="s1">G</span><span class="se">\x15\x03\x9d\xa6\x85</span><span class="s1">6-m1</span><span class="se">\x01</span><span class="s1">=</span><span class="se">\x95\x08\xdc</span><span class="s1">r</span><span class="se">\xd3\xf6\xf7</span><span class="s1">e</span><span class="se">\xb7\xc0\x95</span><span class="s1">]</span><span class="se">\xf4\xc9\xa7\xfa\xdc\xef</span><span class="s1">Q6</span><span class="se">\xc1\x1d\xe6\x08\xeb\x8a\xec</span><span class="s1">]</span><span class="se">\xc9</span><span class="s1">Z=</span><span class="se">\xd3\x9a\xa6\xad</span><span class="s1">(</span><span class="se">\x99</span><span class="s1">$</span><span class="se">\x88\x92</span><span class="s1">@-</span><span class="se">\xab\x12</span><span class="s1">Y</span><span class="se">\xf8\x84</span><span class="s1">G</span><span class="se">\xb2\xb9</span><span class="s1">H</span><span class="se">\xf7\x8f\x1e</span><span class="s1">2d</span><span class="se">\xba</span><span class="s1">$</span><span class="se">\xd2</span><span class="s1">=</span><span class="se">\xf3\xc4\x84\xbd\xd2\xe1\x01\x07\xa1</span><span class="s1">v</span><span class="se">\x18</span><span class="s1">E</span><span class="se">\x1e</span><span class="s1">T</span><span class="se">\x91\x93\x11</span><span class="s1">nAT~@</span><span class="se">\xe7\x02</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xd4\xf5\xd9</span><span class="s1">g</span><span class="se">\x15</span><span class="s1">/w</span><span class="se">\x7f</span><span class="s1">l|Fs</span><span class="se">\xf6\xf0\x92\xf0</span><span class="s1">wP;0</span><span class="se">\x0c\x87\x8a\r\x9c\x1d</span><span class="s1">r</span><span class="se">\xa2</span><span class="s1">eF</span><span class="se">\xc8\xdc</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># cipher explain</span>
</span></span><span class="line"><span class="cl"><span class="n">inp</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;corctf</span><span class="si">{abcdefgh}</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">buf_out</span> <span class="o">=</span> <span class="n">inp</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">buf_out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span><span class="n">iv</span><span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">first</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">16</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">final</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pad</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="mi">16</span><span class="p">:],</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">buf_out</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="n">final</span> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">buf_out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#rev</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">=</span> <span class="n">byte</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">=</span> <span class="n">byte</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># first = p1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># final = p2</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span><span class="n">iv</span><span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">*</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">first</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">final</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">comp_text</span> <span class="o">=</span> <span class="n">first</span><span class="o">+</span><span class="n">final</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">decomp_text</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">comp_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="n">decomp_text</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">p2</span> <span class="o">=</span> <span class="n">decomp_text</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">decomp_text</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="https://i.imgur.com/nGz6WjK.png" alt=""></p>
<p>Flag: <code>corctf{why_w0u1d_4ny0n3_us3_m3mfr0b??}</code></p>
<h2 id="hackermans-dungeon---8-solves--362-points">
<a class="header-anchor" href="#hackermans-dungeon---8-solves--362-points"></a>
hackermans dungeon - 8 solves / 362 points
</h2><blockquote>
<p><strong>Description:</strong>
Hackerman told us he cannot be hacked. Can you hack hackerman?
<strong>Attachment file:</strong>
<a href="https://static.cor.team/uploads/42df4d989f27b7bfbd1c66dcc329644bca70a48c717fdb6e65b3ca53c228fd4f/hackermans_dungeon.exe">hackermans_dungeon.exe</a></p></blockquote>
<p>Riêng bài này thì mình làm ra sau khi giải vừa kết thúc vì mình biết mình bị bjp ạ=)) nên là sẵn viết luôn để đây cho mọi người có nhu cầu tham khảo ạ.</p>
<p>Mở bằng IDA để phân tích thì có 1 điều là nó không hiện các tên hàm và không biết nó làm gì, tuy nhiên mình có sử dụng plug-in <code>findcrypt</code> và debug nhiều lần thì đây là thứ mà mình có được:</p>
<p><img src="https://i.imgur.com/tLmbpaX.png" alt=""></p>
<p>Và thêm 1 vài điều là mình biết trước SHA256 lúc mà nó compare với Buf2. Còn username thì không làm gì nhiều</p>
<p>Ban đầu với flow này, mình đã thử 1 cách đó là tại lúc compare sha256 với buf2, mình đã patch buf2 = sha256 đề cho và pass qua được đoạn check đó, tuy nhiên, debug một hồi mình vẫn không thấy flag đâu.</p>
<p>Thử lại nhiều lần và tìm hiểu kĩ các thuật toán trên thì mình biết được nó dùng các encryption như trên nhưng cũng không giúp ít gì nhiều, mình chỉ biết được là, sau khi làm gì đó với password thì nó dùng đoạn đó để xor với <code>byte_1400740</code>(length  = 35) va rất có thể đây chính là flag. Nhưng tại sau vẫn không đúng nhỉ?</p>
<p>Sau giải thì mình có thử tham khảo mấy anh thì cách duy nhất là crack cái sha256 đó=))) mà ban đầu minh quên mất một điều là, đó chỉ là password chứ không phải flag, còn passwordlist thì trên mạng đầy =)) sax</p>
<p>Thôi thì ngậm ngùi viết script crack pass thôi:</p>
<p><a href="https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt">rockyou.txt</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">Salsa20</span><span class="p">,</span><span class="n">ChaCha20</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">pwhash</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x9c\x00\xf1\xac</span><span class="s2">cb</span><span class="se">\x16\xe2</span><span class="s2">4/d</span><span class="se">\xae</span><span class="s2">;</span><span class="se">\x82\xe3\xc0</span><span class="s2">&#39;I</span><span class="se">\xa6\x9c</span><span class="s2">5</span><span class="se">\xdf\x8c\x03</span><span class="s2">UMU</span><span class="se">\xc1\x01\x86\x9d</span><span class="s2">G&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># username = b&#39;CORnwallis&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#[patch_byte(0x0B010D3F7F0+i,d) for i,d in zip(range(35),b&#34;\x9c\x00\xf1\xaccb\x16\xe24/d\xae;\x82\xe3\xc0&#39;I\xa6\x9c5\xdf\x8c\x03UMU\xc1\x01\x86\x9dG&#34;)]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># byte = b&#39;:\xab5\x81\xd5_V\xb0\xce\xe5\xf5\x16M\xb3\x8d-x#\xd0\x1c\x00\xc1\xec\x07\x19\x022\x91J\xb4c\xcc\xed\xd9\x08&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">SUScrypt</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">password</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">lenpw</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">lenpw</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">password</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">password</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="p">((</span><span class="n">password</span><span class="p">[</span><span class="n">k</span> <span class="o">%</span> <span class="n">lenpw</span><span class="p">]</span> <span class="o">^</span> <span class="n">password</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="mi">98</span><span class="p">))</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">password</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rockyou.txt&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">pw</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(sha256(SUScrypt(pw[:-1])).digest())</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">sha256</span><span class="p">(</span><span class="n">SUScrypt</span><span class="p">(</span><span class="n">pw</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span><span class="o">==</span><span class="n">pwhash</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">pw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span></code></pre></div><p>À mà trong lúc kiểm tra hàm SUScrypt có hoạt động đúng hay không thì mình đã thử debug nhiều lần, mà mình thấy là mặc dù có đoạn md5 nhưng nó không ảnh hưởng đến cái đoạn Buf2 =)), vậy là do nó tác động tới biến khác mà khi mình patch buf2 vẫn không ra flag. Vậy nên trong lúc viết script mình không dùng md5</p>
<p>Chạy xíu thì có được password: <code>canthackmehackers</code></p>
<p>Nhập pass vào, đặt breakpoint, bypass anti-debug và check thử <code>byte_1400740</code>:</p>
<p><img src="https://i.imgur.com/Mrvkgt6.png" alt=""></p>
<p>Để bypass thì tại jnz chỉnh cho ZeroFlag = 1, còn chổ jnb thì chỉnh CarryFlag = 1 là được</p>
<p><img src="https://i.imgur.com/wB4DMHZ.png" alt=""></p>
<p><img src="https://i.imgur.com/Hu6L9vJ.png" alt=""></p>
<p>Flag: <code>corctf{d1d_y0u_h4ck_m3_h4ck3rm4n?}</code></p>
<p>Done!</p>

      
    </div>
    <footer class="article-footer">
      
        






<blockquote class="article-copyright">
  
    <p><strong><span class="icon-user icon"></span>Author：</strong>Le Phu Duc @ You just landed on Jinn&#39;s site, let&#39;s find out..</p>
  
  
  
    <p><strong><span class="icon-pencil icon"></span>Article title：</strong>CORCTF 2022</p>
  
  
    <p><strong><span class="icon-calendar icon"></span>Publication time：</strong>2022-06-28 00:00:00</p>
  
  
  
    <p>
      <strong><span class="icon-copyright icon"></span>Copyright Noice：</strong>All articles on this blog, unless otherwise stated, are licensed under
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"
        ><span class="icon-creative-commons"></span>BY-NC-SA</a
      >
      the license agreement. Please credit the source when sharing.！
    </p>
    <span class="icon-creative-commons article-copyright-bg"></span>
  
</blockquote>

      

      
        <div class="sponsor-wrapper">
  <div class="sponsor-button-wrapper">
    <div class="sponsor-icon rotate"></div>
    <div class="sponsor-title">Sponsor</div>
    <div class="sponsor-icon rotate"></div>
  </div>
  <div class="sponsor-tip">Please buy author a cup of coffee!</div>
  
    <div class="sponsor-qr">
      
        <div class="sponsor-qr-image-wrapper">
          <img src="/images/bmc_qr_lephuduc.png" alt="buymeacoffee.com/lephuduc" width="200" />
          <p class="sponsor-qr-name">buymeacoffee.com/lephuduc</p>
        </div>
      
    </div>
  
</div>
      

      
        

<div class="share-wrapper">
  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:1313/post/corctf2022/" target="_blank" rel="noopener noreferrer" title="CORCTF 2022">
      <div class="share-icon icon icon-facebook">
        
      </div>
    </a>
  
    <a href="https://twitter.com/intent/tweet?url=http://localhost:1313/post/corctf2022/&amp;text=CORCTF%202022&amp;via=http://localhost:1313/" target="_blank" rel="noopener noreferrer" title="CORCTF 2022">
      <div class="share-icon icon icon-twitter">
        
      </div>
    </a>
  
    <a href="https://www.linkedin.com/shareArticle?url=http://localhost:1313/post/corctf2022/&amp;title=CORCTF%202022&amp;summary=Writeup%20for%20CORCTF%202022&amp;mini=true&amp;ro=true" target="_blank" rel="noopener noreferrer" title="CORCTF 2022">
      <div class="share-icon icon icon-linkedin">
        
      </div>
    </a>
  
    <a href="https://www.reddit.com/submit?url=http://localhost:1313/post/corctf2022/&amp;title=CORCTF%202022" target="_blank" rel="noopener noreferrer" title="CORCTF 2022">
      <div class="share-icon icon icon-reddit">
        
      </div>
    </a>
  
</div>
      

      

      

      

      

      
      <ul class="article-tag-list" itemprop="keywords">
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/reverse"
        rel="tag"
        >REVERSE</a
      >
    </li>
  
    <li class="article-tag-list-item" data-aos="zoom-in">
      <a
        class="article-tag-list-link"
        href="/tags/vietnamese"
        rel="tag"
        >VIETNAMESE</a
      >
    </li>
  
</ul>

    </footer>
  </div>
  
    
  <nav
    id="article-nav"
    data-aos="fade-up"
  >
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img
              data-src="https://media.istockphoto.com/id/1404816522/photo/curious-cat-inside-the-cardboard-box-following-the-sounds-outside.jpg?s=612x612&amp;w=0&amp;k=20&amp;c=DvwdGj0leRkaEDgbphRRvo8zPS_M6IrOv7ImdAfh5EQ="
              data-sizes="auto"
              alt="reversing.kr"
              class="lazyload"
            />
          
        
        <a href="http://localhost:1313/post/reversing.kr/"></a>
        <div class="article-nav-caption">Older</div>
        <h3 class="article-nav-title">
          
            reversing.kr
          
        </h3>
      </div>
    

    
      <div class="article-nav-link-wrap article-nav-link-right">
        
          <img
            data-src="/images/post_covers/googlectf2022.jpeg"
            data-sizes="auto"
            alt="Google CTF 2022"
            class="lazyload"
          />
        
        <a href="http://localhost:1313/post/googlectf2022/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            Google CTF 2022
          
        </h3>
      </div>
    
  </nav>


  
</article>










</section>
        </div>
        
        
        



  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  



<footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    <div>
      <span class="icon-copyright"></span>
      2022 -
      2025
      <span class="footer-info-sep rotate"></span>
      Le Phu Duc
    </div>
    
    
    
      <div>
        <span class="icon-brush"
          >&nbsp;
            62.5k
          </span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;
          
          

          05:03
        </span>
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar">
        <div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#microsoft--linux---127-solves122-points">Microsoft ❤️ Linux - 127 solves/122 points</a></li>
    <li><a href="#turbocrab---57-solves154-points">turbocrab - 57 solves/154 points</a></li>
    <li><a href="#msfrob---44-solves170-points">msfrob - 44 solves/170 points</a></li>
    <li><a href="#hackermans-dungeon---8-solves--362-points">hackermans dungeon - 8 solves / 362 points</a></li>
  </ul>
</nav>
  </div>
</div>
      </div>
      <div class="sidebar-common-sidebar hidden">
        
<div class="sidebar-author">
  <img
    data-src="/avatar/shiba.jpg"
    data-sizes="auto"
    alt="Le Phu Duc"
    class="lazyload"
  />
  <div class="sidebar-author-name">Le Phu Duc</div>
  <div class="sidebar-description">a.k.a Jinn</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    
    <div class="sidebar-state-number">19</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">
      2
    </div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">9</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-discord sidebar-social-icon">
      <a
        href="https://discordapp.com/users/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="discord"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-facebook sidebar-social-icon">
      <a
        href="https://www.facebook.com/lephuduc0309"
        itemprop="url"
        target="_blank"
        aria-label="facebook"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a
        href="https://github.com/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="github"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-instagram sidebar-social-icon">
      <a
        href="https://www.instagram.com/le.phuduc"
        itemprop="url"
        target="_blank"
        aria-label="instagram"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-linkedin sidebar-social-icon">
      <a
        href="https://www.linkedin.com/in/lephuduc"
        itemprop="url"
        target="_blank"
        aria-label="linkedin"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
    <div class="icon-twitter sidebar-social-icon">
      <a
        href="https://twitter.com/lephuduck"
        itemprop="url"
        target="_blank"
        aria-label="twitter"
        rel="noopener external nofollow noreferrer"
      ></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe632;
        
      </div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe628;
        
      </div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe604;
        
      </div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/achievements"
        aria-label="Achievements"
      ></a>
      <div class='sidebar-menu-icon icon '>
        
          &#xe621;
        
      </div>
      <div class="sidebar-menu-link">Achievements</div>
    </div>
  
</div>

      </div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
      <div class="site-search">
        <div class="reimu-popup popup">
          <div class="reimu-search">
            <div class="reimu-search-input-icon"></div>
            <div class="reimu-search-input" id="reimu-search-input"></div>
            <div class="popup-btn-close"></div>
          </div>
          <div class="reimu-results">
            <div id="reimu-stats"></div>
            <div id="reimu-hits"></div>
            <div id="reimu-pagination" class="reimu-pagination"></div>
          </div>
          <img class="reimu-bg" src="/images/reimu.png" />
        </div>
      </div>
    
    






  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    
    
    
    
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"
  ></script>




  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    
    
    
    
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"
  ></script>









  
      
      <script src="/js/main.js" ></script>
      



  





  
      
      <script src="/js/aos.js" ></script>
      

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script>








  
      
      <script src="/js/pjax_main.js" data-pjax></script>
      



  <script>
    var ALGOLIA_CONFIG = {
      logo: '\/images\/algolia_logo.svg',
      algolia: {
        applicationID: "",
        apiKey: "",
        indexName: "",
        hits: {
          "per_page": parseInt("10")
        },
        labels: {
          "input_placeholder": "搜索.....",
          "hits_empty": "未发现与 「${query}」相关内容",
          "hits_stats": "找到${hits}条结果（用时 ${time} ms）"
        }
      }
    };
  </script>
  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"
    defer
    
    
    
    integrity="sha384-xvLS0jfKuoREs7pqkRI/OI8GcqohO5S&#43;jQz7ZBtQXnsXmD&#43;9jDOOY4cL6dCPzlrk" crossorigin="anonymous"
  ></script>


  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"
    defer
    
    
    
    integrity="sha384-hHJCflT4KBLQyHfKO9vpstIcFKn/Y&#43;KHTORelMMEn7mOp2AVPp&#43;7fr03dLgZiV3J" crossorigin="anonymous"
  ></script>


  





  
      
      <script src="/js/algolia_search.js" ></script>
      




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/mouse-firework@0.1.0/dist/index.umd.js"
    
    
    
    
    integrity="sha384-KM6i7tu43nYd6e0beIljxHMC5tZc58XBDu7pPA58w50h18Jsx7gLdimfS09RXlKv" crossorigin="anonymous"
  ></script>


<script>
  if (window.firework) {
    const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"#c0971d\",\"#caa02f\",\"#d4aa40\",\"#ddbb62\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"#f4e74d\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
    options.excludeElements = options.excludeelements;
    delete options.excludeelements;
    window.firework(options);
  }
</script>



  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/theme-shokax-pjax@0.0.3/dist/index.umd.js"
    
    
    
    
    integrity="sha384-xneY1WY8hOfUzswrE4CrYq35N4BdVcxqxwHPr9zawE/jMSCxD&#43;jAPU55x/jj3wlf" crossorigin="anonymous"
  ></script>


  <script>
    function loadScripts(scripts, index) {
      if (index < scripts.length) {
        const script = scripts[index];
        const src = script.getAttribute('src');

        const loadScript = (scriptContent) => {
          return new Promise((resolve, reject) => {
            const scriptElement = document.createElement('script');
            if (script.type) {
              scriptElement.type = script.type;
            }
            if (script.src) {
              scriptElement.src = script.src;
              scriptElement.onload = resolve;
              scriptElement.onerror = reject;
            }
            if (scriptContent) {
              scriptElement.text = scriptContent;
            }
            document.head.appendChild(scriptElement);
            if (!script.src) {
              resolve();
            }
          })
          
        }

        ;(src ? loadScript() : loadScript(script.text))
          .then(() => loadScripts(scripts, index + 1))
          .catch(error => {
            console.error(`Failed to load script: ${src || 'inline script'}`, error);
            loadScripts(scripts, index + 1);
          });
      }
    }
    window.Pjax &&
      new window.Pjax({
        selectors: [
          "#header>img",
          "#header>picture",
          "head title",
          "#header-title",
          "#subtitle-wrap",
          "#main",
          "#content",
          ".sidebar-widget",
          ".sidebar-wrapper",
          "#mobile-nav",
          "#lazy-script",
        ],
        switches: {
          "#content": function(oldEl, newEl) {
            
            oldEl.className = newEl.className;
            this.onSwitch();
          },
          "#header-title": Pjax.switches.outerHTML,
          "#subtitle-wrap": Pjax.switches.outerHTML,
          "#main": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.outerHTML = newEl.outerHTML;
            this.onSwitch();
          },
          "#mobile-nav": Pjax.switches.outerHTML,
          "#lazy-script": function (oldEl, newEl) {
            const scripts = [...newEl.querySelectorAll("script")];
            loadScripts(scripts, 0);
            oldEl.innerHTML = newEl.innerHTML;
            this.onSwitch();
          },
        },
        cacheBust: false,
      });
  </script>
  





  
      
      <script src="/js/pjax.js" ></script>
      







<div id="lazy-script">
  <div>
    
      
      
        
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Le Phu Duc",
          title: "CORCTF 2022",
          url: "http:\/\/localhost:1313\/post\/corctf2022\/",
          description: "Writeup for CORCTF 2022",
          cover: "http:\/\/localhost:1313\/images\/post_covers\/corctf2022.jpeg",
        };
      </script>
    
    
    
      





  
      
      <script src="/js/insert_highlight.js" data-pjax></script>
      

      
      
      
      
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;

        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      












      
    
    
  </div>
</div>




  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    
    async
    
    
    integrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"
  ></script>





  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for (let registration of registrations) {
          registration.unregister();
        }
      });
    }
  </script>





  

  
  
  
  
  
  
  <script
    src="https://npm.webcache.cn/aplayer@1.10.1/dist/APlayer.min.js"
    
    
    
    
    integrity="sha384-gdGYZwHnfJM54evoZhpO0s6ZF5BQiybkiyW7VXr&#43;h5UfruuRL/aORyw&#43;5&#43;HZoU6e" crossorigin="anonymous"
  ></script>


  
    <script>
      const ap = new APlayer({
          theme: "var(--color-link)",
          container: document.getElementById('aplayer'),
          audio: JSON.parse("[{\"artist\":\"Lady Gaga, Bruno Mars\",\"cover\":\"/images/song_covers/die_with_a_smile.jpg\",\"lrc\":\"/songs/die_with_a_smile.lrc\",\"name\":\"Die With A Smile\",\"url\":\"/songs/die_with_a_smile.mp3\"},{\"artist\":\"NewJeans (뉴진스)\",\"cover\":\"/images/song_covers/ditto.jpg\",\"lrc\":\"/songs/ditto.lrc\",\"name\":\"Ditto\",\"url\":\"/songs/ditto.mp3\"},{\"artist\":\"Goose house\",\"cover\":\"/images/song_covers/hikarunara.jpg\",\"lrc\":\"/songs/hikarunara.lrc\",\"name\":\"光るなら\",\"url\":\"/songs/hikarunara.mp3\"},{\"artist\":\"back number\",\"cover\":\"/images/song_covers/takaneno_hanakosan.png\",\"lrc\":\"/songs/takaneno_hanakosan.lrc\",\"name\":\"高嶺の花子さん\",\"url\":\"/songs/takaneno_hanakosan.mp3\"}]") || [],
          fixed:  null  || false,
          autoplay:  false  || false,
          loop: 'all' || 'all',
          order: '' || 'list',
          preload: '' || 'auto',
          volume:  null  || 0.7,
          mutex:  null  || true,
          listFolded:  false  || false,
          lrcType:  3  || 0,
      });
    </script>
  



  </body>
</html>
